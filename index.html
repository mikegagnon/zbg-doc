
<!DOCTYPE html>
<meta charset="utf-8">
<html>
  <head>
    
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script src="js/jquery-1.10.1.js"></script>
    <script src="js/d3.v3.js"></script>
    <script src="js/lodash.js"></script>
    <script src="js/sidenote.js"></script>
  </head>
  <body>
    <div class="btn-group addRemoveColumn">
      <button class="btn"><a href="javascript:Sidenote.more()">more columns</a></button>
      <button class="btn"><a href="javascript:Sidenote.less()">fewer columns</a></button>
    </div>
    <div class="headerbox">
<h1>Zen Beer Garden</h1>
    </div>
    <ul id="breadcrumbs" class="breadcrumb"></ul>
    <div id='column-container'>
      <a href="javascript:Sidenote.goBack()"><img id="left-arrow" class="hide-arrow" src="img/left_arrow.png"></a>
      <a href="javascript:Sidenote.goForward()"><img id="right-arrow" class="hide-arrow" src="img/right_arrow.png"></a>
      <div class='column' id="column0"></div>
    </div>
    <div class="content-storage">
<div id='Issue-3672'>
<h2>Issue #3672</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Issue-3672','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='Issue-SOLR-3606'>
<h2>Issue SOLR-3606</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Issue-SOLR-3606','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2012-0022'>
<h2>CVE-2012-0022</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2012-0022','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='SA-CONTRIB-2012-126'>
<h2>SA-CONTRIB-2012-126</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#SA-CONTRIB-2012-126','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2010-4645'>
<h2>CVE-2010-4645</h2>
<p><strong>Software project</strong>: PHP</p>
<p><strong>Year</strong>: 2010</p>
<p><strong>Confidence</strong>: high<a href="javascript:Sidenote.openColumnLoud('#CVE-2010-4645','#conf','*')">*</a></p>
<p><strong>Summary</strong>: &#8220;attackers [can] cause a denial of service (infinite loop) via a certain floating-point value in scientific notation, which is not properly handled in x87 FPU registers&#8221;</p>
<p><strong>Characteristics</strong>: implementation error, corner-case input</p>
<p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4645">Link</a></p>
</div>

<div id='abstract-success'>
<h2>ZBG succeeded for two of the web applications</h2>
<p>TODO</p>
<p>ZBG successfully protected the PHP and Python applications because they have low memory footprints and fast restart times.</p>
<p>A different software approach would be necessary for Zen Beer Garden to successfully defend web applications with high memory footprints or slow restart times.</p>
</div>

<div id='imp-design-imp'>
<h2>Example implementation errors</h2>
<ul>
<li>PHP <a href="javascript:Sidenote.openColumnLoud('#imp-design-imp','#CVE-2011-1471','CVE-2011-1471')">CVE-2011-1471</a></li>
<li>PHP <a href="javascript:Sidenote.openColumnLoud('#imp-design-imp','#CVE-2012-2336','CVE-2012-2336')">CVE-2012-2336</a></li>
<li>PHP <a href="javascript:Sidenote.openColumnLoud('#imp-design-imp','#CVE-2010-4645','CVE-2010-4645')">CVE-2010-4645</a></li>
</ul>
</div>

<div id='handle-cycles'>
<h2>Client Puzzles</h2>
<p>Ari Jules and John Brainard, &#8220;<a href="http://www.internetsociety.org/sites/default/files/juels.pdf">Client Puzzles: A Cryptographic Countermeasure Against Connection Depletion Attacks</a>,&#8221; in Proceedings of NDSS &#8216;99 (Networks and Distributed Security Systems), 1999.</p>
</div>

<div id='surv-method'>
<h2>Methodology</h2>
<p>We searched NIST’s <a href="javascript:Sidenote.openColumnLoud('#surv-method','#nist','National Vulnerability Database')">National Vulnerability Database</a> as well as the public issue trackers for the projects.</p>
<p>This survey is <a href="javascript:Sidenote.openColumnLoud('#surv-method','#surv-exhaustive','not intended to be exhaustive')">not intended to be exhaustive</a>. </p>
<p>It is also worth mentioning that this survey <a href="javascript:Sidenote.openColumnLoud('#surv-method','#surv-pub','only includes publicly documented vulnerabilities')">only includes publicly documented vulnerabilities</a>.</p>
<p>For each potential vulnerability we found, we record its identifier, the year it was reported, a summary, and one or more links.</p>
<p>We also rate our <a href="javascript:Sidenote.openColumnLoud('#surv-method','#surv-confidence','confidence')">confidence</a> that the issue is an exploitable high-density vulnerability. </p>
</div>

<div id='Ticket-7336'>
<h2>Ticket 7336</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Ticket-7336','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='mediawiki'>
<h2>Mediawiki</h2>
<ol>
<li><a href="javascript:Sidenote.openColumnLoud('#mediawiki','#Bug-7601','Bug 7601')">Bug 7601</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#mediawiki','#Bug-18489','Bug 18489')">Bug 18489</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#mediawiki','#CVE-2006-0322','CVE-2006-0322')">CVE-2006-0322</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#mediawiki','#CVE-2012-4885','CVE-2012-4885')">CVE-2012-4885</a></li>
</ol>
</div>

<div id='Ticket-11685'>
<h2>Ticket #11685</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Ticket-11685','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='ror'>
<h2>Ruby on Rails</h2>
<ol>
<li><a href="javascript:Sidenote.openColumnLoud('#ror','#Issue-1525','Issue #1525')">Issue #1525</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#ror','#Issue-2619','Issue #2619')">Issue #2619</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#ror','#Issue-3672','Issue #3672')">Issue #3672</a></li>
</ol>
</div>

<div id='spec-wr'>
<h2>Workers and Requests</h2>
<p>A worker is a thing that attempts to complete requests.</p>
<p>Every worker can complete a certain percentage of <a href="javascript:Sidenote.openColumnLoud('#spec-wr','#spec-legit','legitimate requests')">legitimate requests</a> (<em>Y</em>%) within a certain amount of time (<em>Z</em> seconds).</p>
<p>For example: <em>Nancy can complete 95% of professional requests within 3 hours.</em></p>
</div>

<div id='Bug-18489'>
<h2>Bug 18489</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Bug-18489','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='spec-zbg'>
<h2>The Zen Beer Garden Defense</h2>
<p>Guard every worker with a Bouncer and a Doorman.</p>
<p>Every request for work must go through the Doorman, then the Bouncer, before finally reaching the worker.</p>
<p>For example: <em>If a pharmaceutical rep wants Nancy to read an advertisement, the rep must give the ad to the Doorman, who then passes it to the Bouncer, who then might pass it to Nancy.</em></p>
</div>

<div id='surv-imp-design'>
<h2>Implementation and design errors</h2>
<p>We were able to classify 57% of the vulnerabilities as either implementation errors (24%) or design errors (33%). <a href="javascript:Sidenote.openColumnLoud('#surv-imp-design','#imp-design-note','Note')">Note</a>. </p>
<ul>
<li><a href="javascript:Sidenote.openColumnLoud('#surv-imp-design','#imp-design-imp','Example implementation errors')">Example implementation errors</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#surv-imp-design','#imp-design-design','Example design errors')">Example design errors</a></li>
</ul>
<p><img src="img/imp-design.png"></p>
</div>

<div id='imp-design-note'>
<h2>Note</h2>
<p>For the remaining 43% of vulnerabilities we had insufficient information to determine whether they were implementation or design errors.</p>
</div>

<div id='density'>
<h2>Density</h2>
<p>In the density metaphor, mass measures the victim&#8217;s resource consumption.</p>
<p>Volume measures the number of malicious resource requests.</p>
<p>Density measures the amount of victim resources consumed per malicious request (which, equivalently, is the ratio of mass to volume).</p>
</div>

<div id='Bug-60082'>
<h2>Bug #60082</h2>
<p><strong>Software project</strong>: PHP</p>
<p><strong>Year</strong>: 2011</p>
<p><strong>Confidence</strong>: medium<a href="javascript:Sidenote.openColumnLoud('#Bug-60082','#conf','*')">*</a></p>
<p><strong>Summary</strong>: &#8220;100% CPU / when using references with ArrayObject(&amp;$ref).&#8221; </p>
<p><strong>Characteristics</strong>: unknown</p>
<p><a href="https://bugs.php.net/bug.php?id=60082">Link</a></p>
</div>

<div id='akamai'>
<h2>Akamai</h2>
<p>Akamai’s 2012 <a href="https://www.akamai.com/us/en/about/news/press/2012-press/akamai-first-quarter-2012-state-of-the-internet-report.jsp">The State of the Internet</a> report.</p>
</div>

<div id='recycle'>
<h2>Less recyclable</h2>
<p>Low-density attacks are generally recyclable, in the sense that the same attack can be recycled and used again. They are recyclable since low-density vulnerabilities are inherent to the design of the Internet; defenders have a limited ability to defend themselves from high- volume, low-density attacks.</p>
<p>In contrast, high-density attacks are not generally recyclable since they target specific implementation level vulnerabilities. In most cases, once the defender is subjected to an attack it is straightforward to fix the implementation &#8212; making it invulnerable to that specific attack.</p>
</div>

<div id='main'>
<p>&#8220;If you&#8217;re busy and someone hands you a lemon, hand it back and ask for lemonade.&#8221;</p>
<p>This document presents <em>Zen Beer Garden</em>, a proven approach for defending systems against work-based <a href="javascript:Sidenote.openColumnLoud('#main','#hd','high-density attacks')">high-density attacks</a>. </p>
<p>Today’s applications, frameworks, languages, and servers crumble when subjected to high-density attacks.</p>
<p>High-density vulnerabilities are prevalent. We found 71 high-density vulnerabilities in <a href="javascript:Sidenote.openColumnLoud('#main','#hd-survey','our survey')">our survey</a> of high-density vulnerabilities..</p>
<p>Zen Beer Garden defends against these attacks using a <a href="javascript:Sidenote.openColumnLoud('#main','#abstract-simple','simple approach')">simple approach</a>.</p>
<p>We have <a href="javascript:Sidenote.openColumnLoud('#main','#zbg','experimentally verified')">experimentally verified</a> that Zen Beer Garden can successfully defend web applications against high-density attacks.</p>
<hr>
<p><a href="javascript:Sidenote.openColumnLoud('#main','#howto','How to read this document')">How to read this document</a>.</p>
<p><a href="javascript:Sidenote.openColumnLoud('#main','#bib','Bibliography')">Bibliography</a></p>
</div>

<div id='cdn'>
<h2>Note</h2>
<p>Content-delivery networks offer a form of economical over-provisioning.</p>
</div>

<div id='columns'>
<h2>How columns work</h2>
<p>To increase or decrease the number of columns, click &#8220;<strong>more columns</strong>&#8221; or &#8220;<strong>fewer columns</strong>&#8221; in the upper right corner of the page</p>
<p>If a column is moved off screen, and you want to see that column again, just click the &#8220;<strong>back</strong>&#8221; or &#8220;<strong>forward</strong>&#8221; blue arrows.</p>
<p><img src="img/arrows.png"></p>
</div>

<div id='handle'>
<h2>How do web applications handle high-density attacks?</h2>
<ul>
<li><a href="javascript:Sidenote.openColumnLoud('#handle','#handle-overloaded','Overloaded server behavior')">Overloaded server behavior</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#handle','#handle-timeouts','Timeouts and resource limits')">Timeouts and resource limits</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#handle','#handle-patch','Vulnerability patching')">Vulnerability patching</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#handle','#handle-bouncer','The &amp;#8220;bouncer&amp;#8221; defense')">The &#8220;bouncer&#8221; defense</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#handle','#handle-rate','Rate limiting')">Rate limiting</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#handle','#handle-doorman','The &amp;#8220;doorman&amp;#8221; defense')">The &#8220;doorman&#8221; defense</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#handle','#handle-sig','The &amp;#8220;signature&amp;#8221; defense')">The &#8220;signature&#8221; defense</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#handle','#handle-over','Over-provisioning resources')">Over-provisioning resources</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#handle','#handle-cache','Caching / memoization')">Caching / memoization</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#handle','#handle-switch','Switch to lightweight software')">Switch to lightweight software</a></li>
</ul>
</div>

<div id='python'>
<h2>Python</h2>
<ol>
<li><a href="javascript:Sidenote.openColumnLoud('#python','#CVE-2012-0845','CVE-2012-0845')">CVE-2012-0845</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#python','#CVE-2012-0876','CVE-2012-0876')">CVE-2012-0876</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#python','#CVE-2012-1150','CVE-2012-1150')">CVE-2012-1150</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#python','#CVE-2012-2921','CVE-2012-2921')">CVE-2012-2921</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#python','#Issue-13891','Issue 13891')">Issue 13891</a></li>
</ol>
</div>

<div id='cannon'>
<h2>Low Orbit Ion Cannon</h2>
<p><a href="https://en.wikipedia.org/wiki/Low_Orbit_Ion_Cannon">Low Orbit Ion Cannon</a>, Wikipedia.</p>
</div>

<div id='surv-manip-mal'>
<h2>Examples of malformed-input vulnerabilities</h2>
<ul>
<li>PHP <a href="javascript:Sidenote.openColumnLoud('#surv-manip-mal','#CVE-2011-1471','CVE-2011-1471')">CVE-2011-1471</a></li>
<li>PHP <a href="javascript:Sidenote.openColumnLoud('#surv-manip-mal','#CVE-2012-2336','CVE-2012-2336')">CVE-2012-2336</a></li>
</ul>
</div>

<div id='howto'>
<h2>How to read this document</h2>
<p>This document is presented in <a href="https://github.com/mikegagnon/sidenote">Sidenote</a> format.</p>
<ul>
<li>Click the links you&#8217;re interested ins</li>
<li><a href="javascript:Sidenote.openColumnLoud('#howto','#enlarge','How to enlarge an image')">How to enlarge an image</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#howto','#columns','How columns work')">How columns work</a></li>
</ul>
</div>

<div id='hd-ex'>
<h2>Example work-based high-density attacks</h2>
<p><em>Hypothetical example</em>: Bob transmits a single HTTP request to Wikipedia, which causes Wikipedia to spin so much CPU there&#8217;s a blackout for everyone.</p>
<p><em>Real examples</em>:</p>
<ul>
<li>Bob triggers logic errors that lead to <a href="javascript:Sidenote.openColumnLoud('#hd-ex','#ex-infinite','infinite loops')">infinite loops</a> on the server.</li>
<li>Bob causes an SQL database to execute <a href="javascript:Sidenote.openColumnLoud('#hd-ex','#ex-sql','exorbitantly expensive database operations')">exorbitantly expensive database operations</a>.</li>
<li>Bob triggers <a href="javascript:Sidenote.openColumnLoud('#hd-ex','#ex-re','excessive regular-expression backtracking')">excessive regular-expression backtracking</a>.</li>
</ul>
<p>See also our <a href="javascript:Sidenote.openColumnLoud('#hd-ex','#hd-survey','survey of 71 high-density vulnerabilities')">survey of 71 high-density vulnerabilities</a>.</p>
</div>

<div id='ex-sql'>
<h2>Exorbitantly expensive database operations</h2>
<p>See for example Django Ticket 9479 in our survey as well as our SQL-overload experiment in Section 6.2.8</p>
<p>TODO: Full report</p>
</div>

<div id='Issue-SOLR-3652'>
<h2>Issue SOLR-3652</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Issue-SOLR-3652','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='Issue-SOLR-2855'>
<h2>Issue SOLR-2855</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Issue-SOLR-2855','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2009-2625'>
<h2>CVE-2009-2625</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2009-2625','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='surv-confidence'>
<h2>Confidence</h2>
<p>Sometimes, it is not possible to be sure that the issue is exploitable from the published problem description alone.</p>
</div>

<div id='CVE-2011-0534'>
<h2>CVE-2011-0534</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2011-0534','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2011-4838'>
<h2>CVE-2011-4838</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2011-4838','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2011-2526'>
<h2>CVE-2011-2526</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2011-2526','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='hashdos'>
<h2>HashDoS</h2>
<p>The HashDoS attack against CRuby 1.8 can keep one i7 core 100% busy with an attack rate of 720 bits/s.</p>
<p>See <a href="javascript:Sidenote.openColumnLoud('#hashdos','#klink','Efficient Denial of Service Attacks on Web Application Platforms')">Efficient Denial of Service Attacks on Web Application Platforms</a>.</p>
</div>

<div id='handle-timeouts'>
<h2>Timeouts and resource limits</h2>
<p>Web servers typically enforce timeouts and resource limits on requests. These limits are liberal so that occasional, legitimate high-density requests can be serviced.</p>
<p>Zen Beer Garden differs by only using liberal limits during normal operation, and switching to tight limits during overloads. Some servers, such as Jetty, also tighten up their timeouts in response to overloads.</p>
<p>TODO: Link Jetty</p>
</div>

<div id='handle-switch'>
<h2>Switch to lightweight software</h2>
<p>During overloads web applications can <a href="javascript:Sidenote.openColumnLoud('#handle-switch','#bib-handle-switch','switch')">switch</a> to using more efficient software components, even if it means sacrificing the user experience somewhat. For example, if an overloaded web application replaced an attacked O(N<sup>2</sup>) algorithm for a less desirable O(N) algorithm, the application would defeat the attack.</p>
</div>

<div id='gen-vuln'>
<h2>General vulnerability</h2>
<p>First the design of the TCP/IP protocol suite is inherently vulnerable to low-density attacks since it does not enforce any quality of service (QoS); i.e. the network itself makes no attempt to ensure that misbehaving users can&#8217;t infringe on the quality of service for other users. <a href="javascript:Sidenote.openColumnLoud('#gen-vuln','#atm','Note')">Note</a>.</p>
<p>Second, typical server software does not limit resource usage per user.</p>
<p>Lastly, most Internet servers are under provisioned because straightforward over-provisioning is not cost effective. <a href="javascript:Sidenote.openColumnLoud('#gen-vuln','#cdn','Note')">Note</a>.</p>
<p>These deficiencies make it possible for attackers to consume large amounts of resources simply by submitting large volumes of requests.</p>
</div>

<div id='handle-cache'>
<h2>Caching / memoization</h2>
<p>Caching the results of requests can turn duplicate high-density requests into low-density requests. However clever adversaries can often evade caching by making each high-density request distinct, or by causing the cache to flush. Also, the semantics of applications do not always permit caching.</p>
</div>

<div id='surv-string'>
<h2>The result of errors in string parsing</h2>
<p>When looking at the tasks the vulnerable code performs, we noticed that many vulnerabilities occurred while parsing strings. <a href="javascript:Sidenote.openColumnLoud('#surv-string','#surv-string-ex','Examples')">Examples</a>.</p>
<p>We posit that parsing errors are common primarily because parsers are complex and because attackers have a rich input space to operate within.</p>
<p><img src="img/parsing.png"></p>
</div>

<div id='nist'>
<h2>NIST</h2>
<p>National Institute of Standards and Technology. <a href="http://nvd.nist.gov/">National Vulnerability Database</a>.</p>
</div>

<div id='hd-lately'>
<h2>Note: Lately</h2>
<p>See Akamai’s 2012 <a href="javascript:Sidenote.openColumnLoud('#hd-lately','#akamai','The State of the Internet')">The State of the Internet</a> report, Section 1.4 &#8220;Observed Denial-of-Service (DoS) Attack Activity.&#8221;</p>
</div>

<div id='ex-infinite'>
<h2>Infinite loops</h2>
<p>See for example the <a href="javascript:Sidenote.openColumnLoud('#ex-infinite','#CVE-2010-4645','PHP')">PHP</a> and <a href="javascript:Sidenote.openColumnLoud('#ex-infinite','#CVE-2010-4476','Java')">Java</a> floating-point vulnerabilities.</p>
</div>

<div id='hd-compare-stealth'>
<h2>Stealth</h2>
<p>Low-density attacks are easily detectable since the flood of requests produces many loud observables throughout the network. Monitoring the network &#8212; at any point in the path &#8212; clearly reveals the telltale signs of a DoS flood.</p>
<p>On the other hand, high-density attacks produce fewer observables. In practice, when a system experiences a high-density attack the operator observes the service outage then must troubleshoot to identify the cause. The effects of high-density attacks are often similar to the effects caused by accidental faults in the system.</p>
</div>

<div id='Issue-13891'>
<h2>Issue-13891</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Issue-13891','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='surv-note-na'>
<h2>Note: we couldn&#8217;t find vulnerabilities for some systems</h2>
<p>While we found several CPU consumption issues in OSQA, Nginx, Jetty, and Mongrel, none of them seemed intentionally exploitable by a remote attacker. We therefore don’t include any OSQA, Nginx, Jetty, or Mongrel vulnerabilities in this survey.</p>
</div>

<div id='handle-doorman'>
<h2>The &#8220;doorman&#8221; defense</h2>
<p>The &#8220;<a href="javascript:Sidenote.openColumnLoud('#handle-doorman','#spec','doorman')">doorman</a>&#8221; defense rate limits attackers by charging visitors &#8220;admission fees.&#8221; For example a doorman can require visitors pay admission by spending their own <a href="javascript:Sidenote.openColumnLoud('#handle-doorman','#handle-cycles','CPU cycles')">CPU cycles</a>, <a href="javascript:Sidenote.openColumnLoud('#handle-doorman','#handle-net','network bandwidth')">network bandwidth</a>, and even <a href="javascript:Sidenote.openColumnLoud('#handle-doorman','#handle-human','human labor')">human labor</a>.</p>
<p><a href="javascript:Sidenote.openColumnLoud('#handle-doorman','#zbg','ZBG')">ZBG</a> uses the Doorman defense to rate limit attackers according to their CPU resources.</p>
</div>

<div id='Defect-9796'>
<h2>Defect #9796</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Defect-9796','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='Issue-SOLR-138'>
<h2>Issue SOLR-138</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Issue-SOLR-138','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='simple-hd'>
<h2>Example of an unsophisticated high-density attack</h2>
<p>Consider a web application that uses an inefficient Ω(N<sup>2</sup>) algorithm to process web requests, where N represents the number of HTTP headers. An unsophisticated high-density attack could simply send a request with 10<sup>4</sup> headers, leading to 10<sup>8</sup> computations.</p>
</div>

<div id='CVE-2012-3444'>
<h2>CVE-2012-3444</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2012-3444','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2012-3443'>
<h2>CVE-2012-3443</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2012-3443','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='complex-hd'>
<h2>Example of a sophisticated high-density attack</h2>
<p>Consider the <a href="javascript:Sidenote.openColumnLoud('#complex-hd','#hashdos','HashDoS')">HashDoS</a> vulnerabilities discovered in 2011. The attacks exploit weaknesses in hash algorithms to trigger hash collisions, which leads to N<sup>2</sup> algorithmic performance and a subsequent denial of service.</p>
</div>

<div id='index'>
<h2>Index</h2>
<ul>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#bg-tech','2012 Beer Garden Technical Report')">2012 Beer Garden Technical Report</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-terms','A note on terminology')">A note on terminology</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-eventually','Every legitimate request eventually reaches the worker because the worker will eventually be free or bored at the same time that the legitimate request arrives in the Doorman&amp;#8217;s hands')">Every legitimate request eventually reaches the worker because the worker will eventually be free or bored at the same time that the legitimate request arrives in the Doorman&#8217;s hands</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-ex','Example work-based high-density attack')">Example work-based high-density attack</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#abstract-apps','For our experiments, we installed ZBG over top of four different web applications')">For our experiments, we installed ZBG over top of four different web applications</a>.</li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hashdos','HashDoS')">HashDoS</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-asym','High-density attacks allow small forces to defeat larger forces')">High-density attacks allow small forces to defeat larger forces</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-compare-econ','High-density attacks are *economical*')">High-density attacks are <em>economical</em></a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#recycle','High-density attacks are *less recyclable*')">High-density attacks are <em>less recyclable</em></a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-compare-power','High-density attacks are *powerful*')">High-density attacks are <em>powerful</em></a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#specialized','High-density attacks are *specialized*')">High-density attacks are <em>specialized</em></a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-compare-stealth','High-density attacks are *stealthy*')">High-density attacks are <em>stealthy</em></a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-compare','High-density attacks compared to conventional low-density attacks')">High-density attacks compared to conventional low-density attacks</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#sophisticated','High-density attacks vary in *sophisticated*')">High-density attacks vary in <em>sophisticated</em></a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd','High-density attacks')">High-density attacks</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-survey','High-density vulnerabilities are everywhere')">High-density vulnerabilities are everywhere</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#columns','How columns work')">How columns work</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#handle-cache','How do web applications handle high-density attacks? Caching / memoization')">How do web applications handle high-density attacks? Caching / memoization</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#handle-over','How do web applications handle high-density attacks? Over-provisioning resources')">How do web applications handle high-density attacks? Over-provisioning resources</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#handle-overloaded','How do web applications handle high-density attacks? Overloaded server behavior')">How do web applications handle high-density attacks? Overloaded server behavior</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#handle-rate','How do web applications handle high-density attacks? Rate limiting')">How do web applications handle high-density attacks? Rate limiting</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#handle-switch','How do web applications handle high-density attacks? Switch to lightweight software')">How do web applications handle high-density attacks? Switch to lightweight software</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#handle-bouncer','How do web applications handle high-density attacks? The &amp;#8220;bouncer&amp;#8221; defense')">How do web applications handle high-density attacks? The &#8220;bouncer&#8221; defense</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#handle-doorman','How do web applications handle high-density attacks? The &amp;#8220;doorman&amp;#8221; defense')">How do web applications handle high-density attacks? The &#8220;doorman&#8221; defense</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#handle-sig','How do web applications handle high-density attacks? The &amp;#8220;signature&amp;#8221; defense')">How do web applications handle high-density attacks? The &#8220;signature&#8221; defense</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#handle-timeouts','How do web applications handle high-density attacks? Timeouts and resource limits')">How do web applications handle high-density attacks? Timeouts and resource limits</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#handle-patch','How do web applications handle high-density attacks? Vulnerability patching')">How do web applications handle high-density attacks? Vulnerability patching</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#handle','How do web applications handle high-density attacks?')">How do web applications handle high-density attacks?</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#enlarge','How to enlarge an image')">How to enlarge an image</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#howto','How to read this document')">How to read this document</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-handback','If the Bouncer hands it back, then the Doorman turns the tables on the requester')">If the Bouncer hands it back, then the Doorman turns the tables on the requester</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#surv-imp-design','Implementation and design errors')">Implementation and design errors</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#gen-vuln','Internet services are generally vulnerable to low-density attacks')">Internet services are generally vulnerable to low-density attacks</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#solr-3652','Issue SOLR-3652')">Issue SOLR-3652</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#CVE-2010-4476','Java infinite-loop high-density vulnerability')">Java infinite-loop high-density vulnerability</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-lately','Lately attackers have been increasingly utilizing high-density attacks')">Lately attackers have been increasingly utilizing high-density attacks</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-legit','Legitimate requests')">Legitimate requests</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#low-density','Low-density attacks are conventional floods')">Low-density attacks are conventional floods</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#ld-specialize','Low-density attacks require little-to-no specialization')">Low-density attacks require little-to-no specialization</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#prevalent','Low-density vulnerabilities are more prevalent than high-density vulnerabilities')">Low-density vulnerabilities are more prevalent than high-density vulnerabilities</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#density','Mass, volume, and density metaphor')">Mass, volume, and density metaphor</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#enlarge-req','Note to hackers')">Note to hackers</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#cdn','Note: content-delivery networks offer a form of economical over-provisioning')">Note: content-delivery networks offer a form of economical over-provisioning</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#atm','Note: not all network protocols are inherently vulnerable to low-density attacks')">Note: not all network protocols are inherently vulnerable to low-density attacks</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#surv-note-na','Note: we couldn&amp;#8217;t find vulnerabilities for some systems')">Note: we couldn&#8217;t find vulnerabilities for some systems</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#CVE-2010-4645','PHP infinite-loop high-density vulnerability')">PHP infinite-loop high-density vulnerability</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#django','Survey Django')">Survey Django</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#drupal','Survey Drupal')">Survey Drupal</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#java','Survey Java')">Survey Java</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#mediawiki','Survey MediaWiki')">Survey MediaWiki</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#php','Survey PHP')">Survey PHP</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#python','Survey Python')">Survey Python</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#redmine','Survey Redmine')">Survey Redmine</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#ror','Survey Ruby on Rails')">Survey Ruby on Rails</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#ruby','Survey Ruby')">Survey Ruby</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#solr','Survey Solr')">Survey Solr</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#tomcat','Survey Tomcat')">Survey Tomcat</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#wordpress','Survey WordPress')">Survey WordPress</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec','The algorithm can be summed up as: &amp;#8220;If you&amp;#8217;re busy and someone hands you a lemon, hand it back and ask for lemonade.&amp;#8221;')">The algorithm can be summed up as: &#8220;If you&#8217;re busy and someone hands you a lemon, hand it back and ask for lemonade.&#8221;</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-bbf','The algorithm: Busy, Bored, and Free')">The algorithm: Busy, Bored, and Free</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-intro','The algorithm: Introduction to Zen Beer Garden')">The algorithm: Introduction to Zen Beer Garden</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-overloads','The algorithm: Overloads')">The algorithm: Overloads</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-proof','The algorithm: Proof for Security Guarantee')">The algorithm: Proof for Security Guarantee</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-bouncer','The algorithm: The Bouncer')">The algorithm: The Bouncer</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-doorman','The algorithm: The Doorman')">The algorithm: The Doorman</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-zbg','The algorithm: The Zen Beer Garden Defense')">The algorithm: The Zen Beer Garden Defense</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-sec','The algorithm: Theoretical Security Guarantee')">The algorithm: Theoretical Security Guarantee</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-wr','The algorithm: Workers and Requests')">The algorithm: Workers and Requests</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#surv-string','The result of errors in string parsing')">The result of errors in string parsing</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#surv-exhaustive','This survey is not intended to be exhaustive')">This survey is not intended to be exhaustive</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#surv-pub','This survey only includes publicly documented vulnerabilities')">This survey only includes publicly documented vulnerabilities</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#surv-manip','Triggered by manipulating the input in common ways')">Triggered by manipulating the input in common ways</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#surv-method','Vulnerability survey methodology')">Vulnerability survey methodology</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#surv-confidence','We also rate our confidence that the issue is an exploitable high-density vulnerability')">We also rate our confidence that the issue is an exploitable high-density vulnerability</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#zbg','We have experimentally verified that Zen Beer Garden can successfully defend web applications against high-density attacks')">We have experimentally verified that Zen Beer Garden can successfully defend web applications against high-density attacks</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#surv-soft','We surveyed 16 software software projects')">We surveyed 16 software software projects</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#abstract-success','ZBG succeeded for two of the web applications')">ZBG succeeded for two of the web applications</a>.</li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#abstract-simple','Zen Beer Garden defends against these attacks using a simple approach')">Zen Beer Garden defends against these attacks using a simple approach</a></li>
</ul>
</div>

<div id='CVE-2011-4137'>
<h2>CVE-2011-4137</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2011-4137','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2008-3790'>
<h2>CVE-2008-3790</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2008-3790','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='abstract-simple'>
<h2>Simple approach</h2>
<p>Zen Beer Garden protects each worker with a <em>Doorman</em> and a <em>Bouncer</em>.</p>
<p>The Doorman charges admission fees, which limits the amount of requests the worker receives.</p>
<p>The Bouncer kicks out requests that overload the worker.</p>
<p>The <a href="javascript:Sidenote.openColumnLoud('#abstract-simple','#spec','algorithm')">algorithm</a> can be summed up as: &#8220;If you&#8217;re busy and someone hands you a lemon, hand it back and ask for lemonade.&#8221;</p>
</div>

<div id='Defect-6796'>
<h2>Defect #6796</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Defect-6796','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='enlarge-req'>
<h2>Note to hackers</h2>
<p>I would love a Github pull request on <a href="https://github.com/mikegagnon/sidenote">Sidenote</a>  so that we can enlarge images with an overlay, on click. :-)</p>
</div>

<div id='spec-bbf'>
<h2>Busy, Bored, and Free</h2>
<ul>
<li>A worker is busy if she has been working on her current request for less than <em>Z</em> seconds.</li>
<li>A worker is bored if she has been working on her current request for <em>Z</em> seconds or more.</li>
<li>A worker is free if she isn&#8217;t doing any work at all.</li>
</ul>
</div>

<div id='surv-soft'>
<h2>Survey of 16 software software projects</h2>
<ul>
<li>Languages<ul>
<li><a href="javascript:Sidenote.openColumnLoud('#surv-soft','#php','PHP')">PHP</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#surv-soft','#python','Python')">Python</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#surv-soft','#ruby','Ruby')">Ruby</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#surv-soft','#java','Java')">Java</a></li>
</ul>
</li>
<li>Web-application frameworks<ul>
<li><a href="javascript:Sidenote.openColumnLoud('#surv-soft','#django','Django')">Django</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#surv-soft','#drupal','Drupal')">Drupal</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#surv-soft','#wordpress','WordPress')">WordPress</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#surv-soft','#ror','Ruby on Rails')">Ruby on Rails</a></li>
</ul>
</li>
<li>Web applications<ul>
<li><a href="javascript:Sidenote.openColumnLoud('#surv-soft','#mediawiki','MediaWiki')">MediaWiki</a></li>
<li>OSQA<a href="javascript:Sidenote.openColumnLoud('#surv-soft','#surv-note-na','*')">*</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#surv-soft','#redmine','Redmine')">Redmine</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#surv-soft','#solr','Solr')">Solr</a></li>
</ul>
</li>
<li>Servers:<ul>
<li><a href="javascript:Sidenote.openColumnLoud('#surv-soft','#tomcat','Tomcat')">Tomcat</a></li>
<li>Nginx<a href="javascript:Sidenote.openColumnLoud('#surv-soft','#surv-note-na','*')">*</a></li>
<li>Jetty<a href="javascript:Sidenote.openColumnLoud('#surv-soft','#surv-note-na','*')">*</a></li>
<li>Mongrel<a href="javascript:Sidenote.openColumnLoud('#surv-soft','#surv-note-na','*')">*</a></li>
</ul>
</li>
</ul>
</div>

<div id='abstract-apps'>
<h2>Four different web applications</h2>
<p>TODO</p>
<p>PHP, Python, Java, and Ruby.</p>
</div>

<div id='zbg'>
<h2>Experimentally verified</h2>
<p>To test Zen Beer Garden, we built a software system called <em>ZBG</em>.</p>
<p>ZBG defends web applications against high-density cyber attacks.</p>
<p>For our experiments, we installed ZBG over top of <a href="javascript:Sidenote.openColumnLoud('#zbg','#abstract-apps','four different web applications')">four different web applications</a>.</p>
<p>We subjected the applications to a suite of 10 different attacks of varying sophistication.</p>
<p>ZBG succeeded for <a href="javascript:Sidenote.openColumnLoud('#zbg','#abstract-success','two of the web applications')">two of the web applications</a>.</p>
<p>Our experiments show that Zen Beer Garden works.</p>
</div>

<div id='surv-manip-large'>
<h2>Examples of &#8220;large&#8221; input vulnerabilities</h2>
<ul>
<li>PHP <a href="javascript:Sidenote.openColumnLoud('#surv-manip-large','#CVE-2009-4418','CVE-2009-4418')">CVE-2009-4418</a></li>
<li>PHP <a href="javascript:Sidenote.openColumnLoud('#surv-manip-large','#CVE-2009-4017','CVE-2009-4017')">CVE-2009-4017</a></li>
<li>Python <a href="javascript:Sidenote.openColumnLoud('#surv-manip-large','#CVE-2012-0876','CVE-2012-0876')">CVE-2012-0876</a></li>
<li>Python <a href="javascript:Sidenote.openColumnLoud('#surv-manip-large','#CVE-2012-1150','CVE-2012-1150')">CVE-2012-1150</a></li>
</ul>
</div>

<div id='hd-compare-econ'>
<h2>Economics</h2>
<p>High-density attacks are more economical since they are more <a href="javascript:Sidenote.openColumnLoud('#hd-compare-econ','#hd-compare-power','more powerful')">more powerful</a>.</p>
<p>It is often possible to launch a successful high-density attack using the resources of a single attacker machine.</p>
<p>In contrast, low-density attacks require more attacker resources since they are less potent.</p>
<p>To successfully execute a low-density attack against a well-resourced victim, attackers most often require an entire army of attacking machines (i.e. a botnet).</p>
</div>

<div id='Bug-7601'>
<h2>Bug 7601</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Bug-7601','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2008-5349'>
<h2>CVE-2008-5349</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2008-5349','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='ld-specialize'>
<h2>Little-to-no specialization</h2>
<p>All that is needed is the ability to generate a large volume of traffic towards the victim. There exist a variety of generic, off-the-shelf tools that can be used to launch effective low-density attacks. For example, the <a href="javascript:Sidenote.openColumnLoud('#ld-specialize','#cannon','Low Orbit Ion Cannon')">Low Orbit Ion Cannon</a> can target any web service on the Internet.</p>
</div>

<div id='solr'>
<h2>Solr</h2>
<ol>
<li><a href="javascript:Sidenote.openColumnLoud('#solr','#Issue-SOLR-138','Issue SOLR-138')">Issue SOLR-138</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#solr','#Issue-SOLR-2631','Issue SOLR-2631')">Issue SOLR-2631</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#solr','#Issue-SOLR-2855','Issue SOLR-2855')">Issue SOLR-2855</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#solr','#Issue-SOLR-3243','Issue SOLR-3243')">Issue SOLR-3243</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#solr','#Issue-SOLR-3606','Issue SOLR-3606')">Issue SOLR-3606</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#solr','#Issue-SOLR-3652','Issue SOLR-3652')">Issue SOLR-3652</a></li>
</ol>
</div>

<div id='CVE-2011-4815'>
<h2>CVE-2011-4815</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2011-4815','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='Defect-11275'>
<h2>Defect #11275</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Defect-11275','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='Defect-3449'>
<h2>Defect #3449</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Defect-3449','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='drupal'>
<h2>Drupal</h2>
<ol>
<li><a href="javascript:Sidenote.openColumnLoud('#drupal','#CVE-2012-1588','CVE-2012-1588')">CVE-2012-1588</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#drupal','#Drupd0ssh-exploit','Drupd0s.sh exploit')">Drupd0s.sh exploit</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#drupal','#SA-CONTRIB-2012-126','SA-CONTRIB-2012-126')">SA-CONTRIB-2012-126</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#drupal','#Ticket-1265946','Ticket 1265946')">Ticket 1265946</a></li>
</ol>
</div>

<div id='atm'>
<h2>Note</h2>
<p>Not all network protocols are inherently vulnerable to low-density attacks. For example, the ATM protocol has quality-of-service (QoS) policing built into the network.</p>
</div>

<div id='spec-overloads'>
<h2>Overloads</h2>
<p>A worker can become overloaded under a variety of circumstances.</p>
<p>Requests might be coming in too quickly.</p>
<p>Or, there might be a deluge of work-intensive requests.</p>
<p>Or, in the worst-case scenario, a worker might be subjected to an incessant stream of impossible-to-fulfill requests.</p>
<p>Workers should protect themselves from overloads by employing the Zen Beer Garden defense.</p>
</div>

<div id='Bug-44818'>
<h2>Bug 44818</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Bug-44818','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='ex-re'>
<h2>Excessive regular-expression backtracking</h2>
<p>See for example the Django vulnerability CVE-2009-3695 as well as our regex-overload experiment in Section 6.3.5</p>
<p>TODO: Full report</p>
</div>

<div id='Ticket-19973'>
<h2>Ticket #19973</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Ticket-19973','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='Issue-SOLR-2631'>
<h2>Issue SOLR-2631</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Issue-SOLR-2631','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2009-1190'>
<h2>CVE-2009-1190</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2009-1190','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='Ticket-9479'>
<h2>Ticket 9479</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Ticket-9479','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='Drupd0ssh-exploit'>
<h2>Drupd0s.sh exploit</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Drupd0ssh-exploit','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='Issue-2619'>
<h2>Issue #2619</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Issue-2619','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2012-2921'>
<h2>CVE-2012-2921</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2012-2921','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='hd-asym'>
<h2>Small forces defeat larger forces</h2>
<p>For example, the Rebels used high-density attacks to destroy the Death Star, twice.</p>
<p><img src="img/deathstar.jpg"></p>
</div>

<div id='handle-overloaded'>
<h2>Overloaded server behavior</h2>
<p>During overloads, typical web servers reject incoming requests.</p>
<p>In contrast, Zen Beer Garden evicts over-budget tasks in favor of new requests. Since over-budget tasks tend to be malicious, Zen Beer Garden&#8217;s behavior favors legitimate requests.</p>
</div>

<div id='CVE-2006-0322'>
<h2>CVE-2006-0322</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2006-0322','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2009-1100'>
<h2>CVE-2009-1100</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2009-1100','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='hd-compare-power'>
<h2>Power</h2>
<p>High-density attacks are more <em>powerful</em> than low-density attacks, because high-density attacks create more work, per request.</p>
<p>For example, the <a href="javascript:Sidenote.openColumnLoud('#hd-compare-power','#hashdos','HashDoS')">HashDoS</a> high-density attack can consume 100% CPU using an attack with an attack rate less than 1 kilobit-per-second.</p>
<p>In contrast, low-density attacks are less potent and necessitate a large volume of malicious requests in order to succeed.</p>
</div>

<div id='java'>
<h2>Java</h2>
<ol>
<li><a href="javascript:Sidenote.openColumnLoud('#java','#CVE-2007-3698','CVE-2007-3698')">CVE-2007-3698</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#java','#CVE-2008-5349','CVE-2008-5349')">CVE-2008-5349</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#java','#CVE-2009-1100','CVE-2009-1100')">CVE-2009-1100</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#java','#CVE-2009-1190','CVE-2009-1190')">CVE-2009-1190</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#java','#CVE-2009-2625','CVE-2009-2625')">CVE-2009-2625</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#java','#CVE-2009-3876','CVE-2009-3876')">CVE-2009-3876</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#java','#CVE-2009-3877','CVE-2009-3877')">CVE-2009-3877</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#java','#CVE-2010-4476','CVE-2010-4476')">CVE-2010-4476</a></li>
</ol>
</div>

<div id='handle-bouncer'>
<h2>The &#8220;bouncer&#8221; defense</h2>
<p>Similar to Beer Garden&#8217;s <a href="javascript:Sidenote.openColumnLoud('#handle-bouncer','#spec','Bouncer')">Bouncer</a> component, some overloaded web servers will <a href="javascript:Sidenote.openColumnLoud('#handle-bouncer','#zhou','selectively terminate greedy requests')">selectively terminate greedy requests</a>. These systems are designed to handle occasional bursts of unintentional high-density requests and cannot handle high volumes of high-density requests unless they also rate limit the attacker.</p>
</div>

<div id='spec-doorman'>
<h2>The Doorman</h2>
<p>When the Doorman receives a request from a requester, the Doorman passes it to the Bouncer.</p>
<p>If the Bouncer <a href="javascript:Sidenote.openColumnLoud('#spec-doorman','#spec-handback','hands it back')">hands it back</a>, then the Doorman turns the tables on the requester. Specifically, the Doorman invents some work for the requester to do. The Doorman passes the request back to the requester, and asks the requester to do the work the Doorman just invented.</p>
<p>For example: <em>If a rep wants to show Nancy an ad, but Nancy is busy, the Doorman might ask the rep to write a one-page essay explaining why the ad is relevant to Nancy in particular.</em></p>
<p>These requests are designed to delay the requester while at the same time possibly having the requester do useful work for the worker.</p>
<p>The Doorman will refuse to pass the original request until the requester completes the work request.</p>
<p>If the worker continues to be busy, the Doorman increases the amounts of work he asks of requesters.</p>
<p><em>If Nancy is bombarded by reps, she might ask reps for 10-page essays. Of course, every essay must come with a one-page summary.</em></p>
<p>As the worker becomes less busy, the Doorman decreases the amounts of work he asks of requesters.</p>
</div>

<div id='CVE-2012-1150'>
<h2>CVE-2012-1150</h2>
<p><strong>Software project</strong>: Python</p>
<p><strong>Year</strong>: 2012</p>
<p><strong>Confidence</strong>: high<a href="javascript:Sidenote.openColumnLoud('#CVE-2012-1150','#conf','*')">*</a></p>
<p><strong>Summary</strong>: &#8220;An attacker can cause hash collisions in hash tables used to implement the dict data structure, leading to worst-case algorithmic performance&#8221;</p>
<p><strong>Characteristics</strong>: design error, large input, corner-case input</p>
<p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1150">Link</a></p>
<p><a href="http://bugs.python.org/issue13703">Link</a></p>
<p><a href="http://www.ocert.org/advisories/ocert-2011-003.html">Link</a></p>
<p><a href="javascript:Sidenote.openColumnLoud('#CVE-2012-1150','#klink','Efficient Denial of Service Attacks on Web Application Platforms')">Efficient Denial of Service Attacks on Web Application Platforms</a></p>
</div>

<div id='Issue-1525'>
<h2>Issue #1525</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Issue-1525','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2009-3876'>
<h2>CVE-2009-3876</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2009-3876','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='Issue-SOLR-3243'>
<h2>Issue SOLR-3243</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Issue-SOLR-3243','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='redmine'>
<h2>Redmine</h2>
<ol>
<li><a href="javascript:Sidenote.openColumnLoud('#redmine','#Defect-633','Defect #633')">Defect #633</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#redmine','#Defect-3449','Defect #3449')">Defect #3449</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#redmine','#Defect-5942','Defect #5942')">Defect #5942</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#redmine','#Defect-6796','Defect #6796')">Defect #6796</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#redmine','#Defect-7699','Defect #7699')">Defect #7699</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#redmine','#Defect-9796','Defect #9796')">Defect #9796</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#redmine','#Defect-11106','Defect #11106')">Defect #11106</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#redmine','#Defect-11275','Defect #11275')">Defect #11275</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#redmine','#Patch-9484','Patch #9484')">Patch #9484</a></li>
</ol>
</div>

<div id='wordpress'>
<h2>Wordpress</h2>
<ol>
<li><a href="javascript:Sidenote.openColumnLoud('#wordpress','#Ticket-11685','Ticket #11685')">Ticket #11685</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#wordpress','#Ticket-19973','Ticket #19973')">Ticket #19973</a></li>
</ol>
</div>

<div id='spec-sec'>
<h2>Theoretical Security Guarantee</h2>
<p>Zen Beer Garden is 100% effective.&#42;</p>
<p>If you use the Zen Beer Garden defense, you will never&#42; become overloaded. No matter what,&#42; <em>Y%</em> of legitimate requests are guaranteed to eventually complete.</p>
<p>&#42; <em>As long Doormen and Bouncers don’t get overloaded, legitimate requesters are patient, legitimate requesters are willing to work, your boss is competent, etc.</em></p>
</div>

<div id='surv-string-ex'>
<h2>Examples of string-parsing vulnerabilities</h2>
<ul>
<li>PHP <a href="javascript:Sidenote.openColumnLoud('#surv-string-ex','#CVE-2012-2336','CVE-2012-2336')">CVE-2012-2336</a></li>
<li>Python <a href="javascript:Sidenote.openColumnLoud('#surv-string-ex','#CVE-2012-0876','CVE-2012-0876')">CVE-2012-0876</a></li>
</ul>
</div>

<div id='CVE-2012-1588'>
<h2>CVE-2012-1588</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2012-1588','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='imp-design-design'>
<h2>Example design errors</h2>
<ul>
<li>PHP <a href="javascript:Sidenote.openColumnLoud('#imp-design-design','#CVE-2011-4885','CVE-2011-4885')">CVE-2011-4885</a></li>
<li>PHP <a href="javascript:Sidenote.openColumnLoud('#imp-design-design','#CVE-2009-4418','CVE-2009-4418')">CVE-2009-4418</a></li>
<li>PHP <a href="javascript:Sidenote.openColumnLoud('#imp-design-design','#CVE-2009-4017','CVE-2009-4017')">CVE-2009-4017</a></li>
<li>Python <a href="javascript:Sidenote.openColumnLoud('#imp-design-design','#CVE-2012-0876','CVE-2012-0876')">CVE-2012-0876</a></li>
<li>Python <a href="javascript:Sidenote.openColumnLoud('#imp-design-design','#CVE-2012-1150','CVE-2012-1150')">CVE-2012-1150</a></li>
</ul>
</div>

<div id='handle-human'>
<h2>WebSOS</h2>
<p>Angelos Stavrou et al., &#8220;<a href="https://www.cs.columbia.edu/~angelos/Papers/2005/websos-jcn.pdf">WebSOS: An Overlay-based System For Protecting Web Servers From Denial of Service Attacks</a>,&#8221; in Computer Networks: The International Journal of Computer and Telecommunications Networking - Web security, vol. 48, 2005.</p>
</div>

<div id='solr-3652'>
<h2>Issue SOLR-3652</h2>
<p>TODO. See section 3.12</p>
</div>

<div id='hd-compare'>
<h2>Compared to conventional low-density attacks</h2>
<p><a href="javascript:Sidenote.openColumnLoud('#hd-compare','#density','Mass, volume, and density metaphor')">Mass, volume, and density metaphor</a></p>
<p>Low-density attacks are <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#low-density','conventional floods')">conventional floods</a>.</p>
<p>Low-density vulnerabilities are <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#prevalent','more prevalent')">more prevalent</a> than high-density vulnerabilities.</p>
<p>High-density attacks are <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#hd-compare-power','powerful')">powerful</a>, <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#hd-compare-econ','economical')">economical</a>, <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#hd-compare-stealth','stealthy')">stealthy</a>, <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#specialized','specialized')">specialized</a>, <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#recycle','less recyclable')">less recyclable</a>, and they vary in <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#sophisticated','sophistication')">sophistication</a>.</p>
<p><img src="img/compare.png"></p>
</div>

<div id='handle-net'>
<h2>DDoS Defense by Offense</h2>
<p>Michael Walfish, Mythili Vutukuru, Hari Balakrishnan, David Karger, and Scott Shenker, &#8220;<a href="http://nms.csail.mit.edu/papers/speakup-tocs10.pdf">DDoS Defense by Offense</a>,&#8221; in ACM SIGCOMM, 2006</p>
</div>

<div id='Bug-61240'>
<h2>Bug #61240</h2>
<p><strong>Software project</strong>: PHP</p>
<p><strong>Year</strong>: 2012</p>
<p><strong>Confidence</strong>: medium<a href="javascript:Sidenote.openColumnLoud('#Bug-61240','#conf','*')">*</a></p>
<p><strong>Summary</strong>: &#8220;In the document of curl_multi_exec, has a example in the document. it can run in php 5.2, but php 5.3 and php 5.4 cause cpu load 100%. Note: it seems that high CPU consumption only occurs if the developer misuses the libcurl library.&#8221;</p>
<p><strong>Characteristics</strong>: unknown</p>
<p><a href="https://bugs.php.net/bug.php?id=61240">Link</a></p>
</div>

<div id='handle-over'>
<h2>Over-provisioning resources</h2>
<p>As a generic defense against DoS attacks, administrators may over-provision servers, allocating significantly more resources than are needed for legitimate traffic. Content-delivery networks, such as Akamai, provide such over provisioning as a service.</p>
<p>Such systems are still vulnerable to high-density attacks, because &#8220;infinite-density&#8221; attacks can consume even the largest resource pools.</p>
</div>

<div id='spec-bouncer'>
<h2>The Bouncer</h2>
<p>If the worker is free, the Bouncer passes the request to the worker.</p>
<p>If the worker is bored, the Bouncer asks the worker to stop working on her current task and accept the new request. The Bouncer then informs the old requester that her request was bounced.</p>
<p>If the worker is busy, the Bouncer hands the request back to the Doorman.</p>
</div>

<div id='sophisticated'>
<h2>Sophisticated</h2>
<p>High-density attacks vary in the sophistication required to conduct the attack. <a href="javascript:Sidenote.openColumnLoud('#sophisticated','#simple-hd','Unsophisticated example')">Unsophisticated example</a>. </p>
<p>Many high-density vulnerabilities require sophisticated attacks. <a href="javascript:Sidenote.openColumnLoud('#sophisticated','#complex-hd','Sophisticated example')">Sophisticated example</a>.</p>
</div>

<div id='hd-terms'>
<h2>A note on terminology</h2>
<p>For the sake of brevity, throughout the rest of this document, unless specified otherwise, the term <em>high-density attack</em> refers to <em>work-based high-density cyber attack</em>.</p>
<p>Zen Beer Garden only defends against <em>work-based</em> attacks.</p>
<p>Our experimental implementation, <a href="javascript:Sidenote.openColumnLoud('#hd-terms','#zbg','ZBG')">ZBG</a>, only defends against work-based <em>cyber</em> attacks.</p>
</div>

<div id='hd-survey'>
<h2>Vulnerabilities</h2>
<p>We <a href="javascript:Sidenote.openColumnLoud('#hd-survey','#surv-soft','surveyed 16 software software projects')">surveyed 16 software software projects</a>, and found 71 high-density vulnerabilities.</p>
<p>We performed our survey by <a href="javascript:Sidenote.openColumnLoud('#hd-survey','#surv-method','searching public databases')">searching public databases</a>.</p>
<p>Our survey reveals that high-density vulnerabilities are often:</p>
<ul>
<li><a href="javascript:Sidenote.openColumnLoud('#hd-survey','#surv-imp-design','Implementation and design errors')">Implementation and design errors</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#hd-survey','#surv-manip','Triggered by manipulating the input in common ways')">Triggered by manipulating the input in common ways</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#hd-survey','#surv-string','The result of errors in string parsing')">The result of errors in string parsing</a></li>
</ul>
</div>

<div id='ruby'>
<h2>Ruby</h2>
<ol>
<li><a href="javascript:Sidenote.openColumnLoud('#ruby','#CVE-2004-0983','CVE-2004-0983')">CVE-2004-0983</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#ruby','#CVE-2006-5467','CVE-2006-5467')">CVE-2006-5467</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#ruby','#CVE-2008-3656','CVE-2008-3656')">CVE-2008-3656</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#ruby','#CVE-2008-3790','CVE-2008-3790')">CVE-2008-3790</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#ruby','#CVE-2008-4310','CVE-2008-4310')">CVE-2008-4310</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#ruby','#CVE-2011-4815','CVE-2011-4815')">CVE-2011-4815</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#ruby','#CVE-2011-4838','CVE-2011-4838')">CVE-2011-4838</a></li>
</ol>
</div>

<div id='handle-rate'>
<h2>Rate limiting</h2>
<p>A common approach to DoS defense is rate limiting. If you can sufficiently limit the attacker&#8217;s rate of admission, it is possible to defend against high-density attacks. However, most off-the-shelf admission controls have a limited ability to rate limit attackers. For example, a rate limiter based on IP addresses won&#8217;t work against an adversary with many IP addresses. Similarly, a rate limiter based on username won&#8217;t work against logged out users.</p>
</div>

<div id='hd'>
<h2>High-density attacks</h2>
<p>A high-density attack is when a tiny bomb causes a huge explosion.</p>
<p>A <em>work-based</em> high-density attack is one where the tiny bomb causes the victim to perform an explosive amount of work. <a href="javascript:Sidenote.openColumnLoud('#hd','#hd-ex','Examples')">Examples</a>.</p>
<p><a href="javascript:Sidenote.openColumnLoud('#hd','#hd-terms','A note on terminology')">A note on terminology</a>.</p>
<p><a href="javascript:Sidenote.openColumnLoud('#hd','#hd-compare','Compared to conventional low-density attacks')">Compared to conventional low-density attacks</a>, high density attacks are particularly dangerous because they are particularly powerful, economical, and stealthy.</p>
<p>With high-density attacks, you don’t need an entire army to attack your enemies. You just need tiny bombs.</p>
<p>High-density attacks allow <a href="javascript:Sidenote.openColumnLoud('#hd','#hd-asym','small forces to defeat larger forces')">small forces to defeat larger forces</a>.</p>
<p>High-density <a href="javascript:Sidenote.openColumnLoud('#hd','#hd-survey','vulnerabilities')">vulnerabilities</a> are prevalent.</p>
<p><a href="javascript:Sidenote.openColumnLoud('#hd','#hd-lately','Lately')">Lately</a>, attackers have been increasingly utilizing high-density attacks since the defenses against conventional DoS attacks are becoming increasingly effective.</p>
<p>How do web applications <a href="javascript:Sidenote.openColumnLoud('#hd','#handle','handle')">handle</a> high-density attacks?</p>
</div>

<div id='Ticket-1265946'>
<h2>Ticket 1265946</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Ticket-1265946','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='surv-manip'>
<h2>Triggered by manipulating the input in common ways</h2>
<p>37% of vulnerabilities are triggered with &#8220;large&#8221; inputs. <a href="javascript:Sidenote.openColumnLoud('#surv-manip','#surv-manip-large','Examples')">Examples</a>.</p>
<p>21% of vulnerabilities are triggered with &#8220;corner-case&#8221; input. <a href="javascript:Sidenote.openColumnLoud('#surv-manip','#surv-manip-corner','Examples')">Examples</a>.</p>
<p>11% of vulnerabilities are triggered with malformed input &#8212; input that is either syntactically or
semantically invalid. <a href="javascript:Sidenote.openColumnLoud('#surv-manip','#surv-manip-mal','Examples')">Examples</a>.</p>
<p><img src="img/invalid.png"></p>
</div>

<div id='spec-proof'>
<h2>Proof for Security Guarantee</h2>
<p>At least <em>Y</em>% of legitimate requests that reach the worker complete. We know this because the Bouncer only bounces a request after the worker has been working on it for at least <em>Z</em> seconds.</p>
<p>Every legitimate request eventually reaches the worker because the worker will <a href="javascript:Sidenote.openColumnLoud('#spec-proof','#spec-eventually','eventually')">eventually</a> be free or bored at the same time that the legitimate request arrives in the Doorman&#8217;s hands. Of course, the requester might have performed quite a bit of work in order to convince the Doorman to accept the request.</p>
</div>

<div id='spec'>
<h2>Algorithm</h2>
<p>This section provides the algorithmic specification for Zen Beer Garden, it&#8217;s security guarantee, and a simple proof.</p>
<ul>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-wr','Workers and Requests')">Workers and Requests</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-bbf','Busy, Bored, and Free')">Busy, Bored, and Free</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-overloads','Overloads')">Overloads</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-intro','Introduction to Zen Beer Garden')">Introduction to Zen Beer Garden</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-sec','Theoretical Security Guarantee')">Theoretical Security Guarantee</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-zbg','The Zen Beer Garden Defense')">The Zen Beer Garden Defense</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-bouncer','The Bouncer')">The Bouncer</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-doorman','The Doorman')">The Doorman</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-proof','Proof for Security Guarantee')">Proof for Security Guarantee</a></li>
</ul>
</div>

<div id='Patch-9484'>
<h2>Patch #9484</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Patch-9484','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2012-4885'>
<h2>CVE-2012-4885</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2012-4885','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='Defect-11106'>
<h2>Defect #11106</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Defect-11106','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2012-0845'>
<h2>CVE-2012-0845</h2>
<p><strong>Software project</strong>: Python</p>
<p><strong>Year</strong>: 2012</p>
<p><strong>Confidence</strong>: high<a href="javascript:Sidenote.openColumnLoud('#CVE-2012-0845','#conf','*')">*</a></p>
<p><strong>Summary</strong>: &#8220;A denial of service flaw was found in the way Simple XML-RPC Server module of Python processed client connections, that were closed prior the complete request body has been received. A remote attacker could use this flaw to cause Python Simple XML-RPC based server process to consume excessive amount of CPU.&#8221;</p>
<p><strong>Characteristics</strong>: unknown</p>
<p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=/CVE-2012-0845">Link</a></p>
<p><a href="http://bugs.python.org/issue14001">Link</a></p>
</div>

<div id='specialized'>
<h2>Specialization</h2>
<p>Low-density attacks require <a href="javascript:Sidenote.openColumnLoud('#specialized','#ld-specialize','little-to-no specialization')">little-to-no specialization</a> in order to attack a particular target.</p>
<p>High-density attacks on the other hand require attacks tailored to application-specific vulnerabilities. For example, an attack might need to exploit an underflow to cause excessive looping, as exemplified by <a href="javascript:Sidenote.openColumnLoud('#specialized','#solr-3652','Issue SOLR-3652')">Issue SOLR-3652</a>.</p>
</div>

<div id='CVE-2008-4310'>
<h2>CVE-2008-4310</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2008-4310','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='klink'>
<h2>Efficient Denial of Service Attacks on Web Application Platforms</h2>
<p>Alexander Klink and Julian Walde, &#8220;<a href="https://events.ccc.de/congress/2011/Fahrplan/attachments/2007_28C3_Effective_DoS_on_web_application_platforms.pdf">Efficient Denial of Service Attacks on Web Application Platforms</a>,&#8221; in The 28th Chaos Communication Congress, 2011.</p>
</div>

<div id='spec-legit'>
<h2>Legitimate requests</h2>
<p>A request is legitimate if it is <em>not</em> intended to overload the worker.</p>
<p>A request is malicious if it is intended to overload the worker.</p>
</div>

<div id='Defect-633'>
<h2>Defect #633</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Defect-633','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2007-3698'>
<h2>CVE-2007-3698</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2007-3698','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2009-3877'>
<h2>CVE-2009-3877</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2009-3877','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2011-4885'>
<h2>CVE-2011-4885</h2>
<p><strong>Software project</strong>: PHP</p>
<p><strong>Year</strong>: 2011</p>
<p><strong>Confidence</strong>: high<a href="javascript:Sidenote.openColumnLoud('#CVE-2011-4885','#conf','*')">*</a></p>
<p><strong>Summary</strong>: PHP &#8220;computes hash values for form parameters without restricting the ability to trigger hash collisions predictably, which allows remote attackers to cause a denial of service (CPU consumption) by sending many crafted parameters.&#8221;</p>
<p><strong>Characteristics</strong>: design error, corner-case input</p>
<p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4885">Link</a></p>
</div>

<div id='handle-sig'>
<h2>The &#8220;signature&#8221; defense</h2>
<p>Firewalls and signature-based intrusion-detection systems are generally ineffective against 0-day high-density attacks because it is difficult to know, a priori, how high-density requests will appear different from low-density requests. Such knowledge is necessary to develop signatures ahead of time.</p>
<p><a href="javascript:Sidenote.openColumnLoud('#handle-sig','#zbg','ZBG')">ZBG</a> uses a form of signature-based detection by dynamically learning signatures, in real time while an attack happens.</p>
</div>

<div id='CVE-2009-4418'>
<h2>CVE-2009-4418</h2>
<p><strong>Software project</strong>: PHP</p>
<p><strong>Year</strong>: 2009</p>
<p><strong>Confidence</strong>: high<a href="javascript:Sidenote.openColumnLoud('#CVE-2009-4418','#conf','*')">*</a></p>
<p><strong>Summary</strong>: &#8220;attackers [can] cause a denial of service (resource consumption) via a deeply nested serialized variable&#8221;</p>
<p><strong>Characteristics</strong>: design error, large input </p>
<p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4418">Link</a></p>
</div>

<div id='bg-tech'>
<h2>2012 Beer Garden Technical Report</h2>
<p>TODO</p>
</div>

<div id='conf'>
<h2>Note on confidence</h2>
<p>Confidence marks how confident we are that the issue is actually exploitable.</p>
</div>

<div id='low-density'>
<h2>Flood</h2>
<p>In a flood attack, the attacker consumes a <em>massive</em> amount of victim resources by flooding the victim with a large <em>volume</em> of resource requests.</p>
<p>For a low-density attack to be effective, the attacker must generate a large volume of requests, which can be accomplished using an army of attack computers (such as a botnet).</p>
</div>

<div id='surv-pub'>
<h2>Only includes publicly documented vulnerabilities</h2>
<p>We have found that applications often have trivial, undocumented vulnerabilities. For example, if an application request accepts N items, then a request containing an extreme number of items might consume significant resources. We discovered and exploited several such trivial attacks in our experiments. We also note that the accuracy of our survey is limited; it is not always possible to know from descriptions and discussions alone if a bug is truly an exploitable vulnerability.</p>
</div>

<div id='surv-manip-corner'>
<h2>Examples of &#8220;corner-case&#8221; vulnerabilities</h2>
<ul>
<li>PHP <a href="javascript:Sidenote.openColumnLoud('#surv-manip-corner','#CVE-2011-4885','CVE-2011-4885')">CVE-2011-4885</a></li>
<li>PHP <a href="javascript:Sidenote.openColumnLoud('#surv-manip-corner','#CVE-2010-4645','CVE-2010-4645')">CVE-2010-4645</a></li>
<li>Python <a href="javascript:Sidenote.openColumnLoud('#surv-manip-corner','#CVE-2012-0876','CVE-2012-0876')">CVE-2012-0876</a></li>
<li>Python <a href="javascript:Sidenote.openColumnLoud('#surv-manip-corner','#CVE-2012-1150','CVE-2012-1150')">CVE-2012-1150</a></li>
</ul>
</div>

<div id='Defect-5942'>
<h2>Defect #5942</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Defect-5942','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2012-2336'>
<h2>CVE-2012-2336</h2>
<p><strong>Software project</strong>: PHP</p>
<p><strong>Year</strong>: 2012</p>
<p><strong>Confidence</strong>: high<a href="javascript:Sidenote.openColumnLoud('#CVE-2012-2336','#conf','*')">*</a></p>
<p><strong>Summary</strong>: PHP-CGI &#8220;does not properly handle query strings that lack an = (equals sign) character, which allows remote attackers to cause a denial of service (resource consumption) by placing command-line options in the query string&#8221;</p>
<p><strong>Characteristics</strong>: implementation error, malformed input, string parsing</p>
<p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-2336">Link</a></p>
</div>

<div id='handle-patch'>
<h2>Vulnerability patching</h2>
<p>Perhaps the most common way developers defend against high-density attacks is identifying and patching specific high-density vulnerabilities. This approach only provides a limited defense since prevention and identification is laborious and error prone. Further, patching cannot defend against 0-day attacks (unlike Zen Beer Garden).</p>
</div>

<div id='enlarge'>
<h2>How to enlarge an image</h2>
<p>Decrease the number of columns by clicking &#8220;<strong>fewer columns</strong>&#8221; in the upper right-hand corner. The fewer the columns, the larger the image.</p>
<p>When you&#8217;re done, click &#8220;<strong>more columns</strong>&#8221; until you&#8217;re happy with the number of columns.</p>
<p>Try it out.</p>
<p><img src="img/deathstar.jpg"></p>
<p><a href="javascript:Sidenote.openColumnLoud('#enlarge','#enlarge-req','Note to hackers')">Note to hackers</a>.</p>
</div>

<div id='Defect-7699'>
<h2>Defect #7699</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Defect-7699','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2005-3510'>
<h2>CVE-2005-3510</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2005-3510','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2009-4017'>
<h2>CVE-2009-4017</h2>
<p><strong>Software project</strong>: PHP</p>
<p><strong>Year</strong>: 2009</p>
<p><strong>Confidence</strong>: high<a href="javascript:Sidenote.openColumnLoud('#CVE-2009-4017','#conf','*')">*</a></p>
<p><strong>Summary</strong>: PHP &#8220;does not restrict the number of temporary files created when handling a multipart/form- data POST request, which allows remote attackers to cause a denial of service (resource exhaustion)&#8221;</p>
<p><strong>Characteristics</strong>: design error, large input</p>
<p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4017">Link</a></p>
</div>

<div id='CVE-2012-0876'>
<h2>CVE-2012-0876</h2>
<p><strong>Software project</strong>: Python</p>
<p><strong>Year</strong>: 2012</p>
<p><strong>Confidence</strong>: high<a href="javascript:Sidenote.openColumnLoud('#CVE-2012-0876','#conf','*')">*</a></p>
<p><strong>Summary</strong>: &#8220;The XML parser (xmlparse.c) in expat before 2.1.0 computes hash values without restricting the ability to trigger hash collisions predictably, which allows context-dependent attackers to cause a denial of service (CPU consumption) via an XML file with many identifiers with the same value.&#8221;</p>
<p><strong>Characteristics</strong>: design error, large input, corner-case input, string parsing</p>
<p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0876">Link</a></p>
<p><a href="http://bugs.python.org/issue14234">Link</a></p>
</div>

<div id='spec-intro'>
<h2>Introduction to Zen Beer Garden</h2>
<p>You should protect workers from overloads by placing Doormen and Bouncers between workers and requesters.</p>
<p>Theoretically, the Zen Beer Garden defense is 100% effective, even against the most threatening deluges.</p>
<p>In practice, the Zen Beer Garden defense tends to be effective, although there are many reasons the defense might fail.</p>
</div>

<div id='surv-exhaustive'>
<h2>Not intended to be exhaustive</h2>
<p>We primarily focused our search on the vulnerability history in the years leading up to, and including, 2012. We also specifically searched for work-based high-density vulnerabilities, though we also report other types of high-density vulnerabilities we came across.</p>
</div>

<div id='CVE-2008-3656'>
<h2>CVE-2008-3656</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2008-3656','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='zhou'>
<h2>Selective early request termination for busy internet services</h2>
<p>Jingyu Zhou and Tao Yang, &#8220;<a href="http://www2006.wwwconference.org/programme/files/pdf/2011.pdf">Selective early request termination for busy internet services</a>,&#8221; in WWW &#8216;06 Proceedings of the 15th international conference on World Wide Web, vol. 2006.</p>
</div>

<div id='bib'>
<h2>Bibligraphy</h2>
<ol>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Bug-60082','Bug #60082')">Bug #60082</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Bug-61240','Bug #61240')">Bug #61240</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Bug-18489','Bug 18489')">Bug 18489</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Bug-44818','Bug 44818')">Bug 44818</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Bug-7601','Bug 7601')">Bug 7601</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2004-0983','CVE-2004-0983')">CVE-2004-0983</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2005-3510','CVE-2005-3510')">CVE-2005-3510</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2006-0322','CVE-2006-0322')">CVE-2006-0322</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2006-5467','CVE-2006-5467')">CVE-2006-5467</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2007-3698','CVE-2007-3698')">CVE-2007-3698</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2007-5712','CVE-2007-5712')">CVE-2007-5712</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2008-3656','CVE-2008-3656')">CVE-2008-3656</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2008-3790','CVE-2008-3790')">CVE-2008-3790</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2008-4310','CVE-2008-4310')">CVE-2008-4310</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2008-5349','CVE-2008-5349')">CVE-2008-5349</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2009-1100','CVE-2009-1100')">CVE-2009-1100</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2009-1190','CVE-2009-1190')">CVE-2009-1190</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2009-2625','CVE-2009-2625')">CVE-2009-2625</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2009-3695','CVE-2009-3695')">CVE-2009-3695</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2009-3876','CVE-2009-3876')">CVE-2009-3876</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2009-3877','CVE-2009-3877')">CVE-2009-3877</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2009-4017','CVE-2009-4017')">CVE-2009-4017</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2009-4418','CVE-2009-4418')">CVE-2009-4418</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2010-4476','CVE-2010-4476')">CVE-2010-4476</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2010-4476','CVE-2010-4476')">CVE-2010-4476</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2010-4535','CVE-2010-4535')">CVE-2010-4535</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2010-4645','CVE-2010-4645')">CVE-2010-4645</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2011-0534','CVE-2011-0534')">CVE-2011-0534</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2011-1471','CVE-2011-1471')">CVE-2011-1471</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2011-2526','CVE-2011-2526')">CVE-2011-2526</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2011-4137','CVE-2011-4137')">CVE-2011-4137</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2011-4815','CVE-2011-4815')">CVE-2011-4815</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2011-4838','CVE-2011-4838')">CVE-2011-4838</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2011-4858','CVE-2011-4858')">CVE-2011-4858</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2011-4885','CVE-2011-4885')">CVE-2011-4885</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2012-0022','CVE-2012-0022')">CVE-2012-0022</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2012-0845','CVE-2012-0845')">CVE-2012-0845</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2012-0876','CVE-2012-0876')">CVE-2012-0876</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2012-1150','CVE-2012-1150')">CVE-2012-1150</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2012-1588','CVE-2012-1588')">CVE-2012-1588</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2012-2336','CVE-2012-2336')">CVE-2012-2336</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2012-2921','CVE-2012-2921')">CVE-2012-2921</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2012-3443','CVE-2012-3443')">CVE-2012-3443</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2012-3444','CVE-2012-3444')">CVE-2012-3444</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#CVE-2012-4885','CVE-2012-4885')">CVE-2012-4885</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#handle-cycles','Client Puzzles: A Cryptographic Countermeasure Against Connection Depletion Attacks')">Client Puzzles: A Cryptographic Countermeasure Against Connection Depletion Attacks</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#handle-net','DDoS Defense by Offense')">DDoS Defense by Offense</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Defect-11106','Defect #11106')">Defect #11106</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Defect-11275','Defect #11275')">Defect #11275</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Defect-3449','Defect #3449')">Defect #3449</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Defect-5942','Defect #5942')">Defect #5942</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Defect-633','Defect #633')">Defect #633</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Defect-6796','Defect #6796')">Defect #6796</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Defect-7699','Defect #7699')">Defect #7699</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Defect-9796','Defect #9796')">Defect #9796</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Drupd0ssh-exploit','Drupd0s.sh exploit')">Drupd0s.sh exploit</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#klink','Efficient Denial of Service Attacks on Web Application Platforms')">Efficient Denial of Service Attacks on Web Application Platforms</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Issue-1525','Issue #1525')">Issue #1525</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Issue-2619','Issue #2619')">Issue #2619</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Issue-3672','Issue #3672')">Issue #3672</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Issue-13891','Issue 13891')">Issue 13891</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Issue-SOLR-138','Issue SOLR-138')">Issue SOLR-138</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Issue-SOLR-2631','Issue SOLR-2631')">Issue SOLR-2631</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Issue-SOLR-2855','Issue SOLR-2855')">Issue SOLR-2855</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Issue-SOLR-3243','Issue SOLR-3243')">Issue SOLR-3243</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Issue-SOLR-3606','Issue SOLR-3606')">Issue SOLR-3606</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Issue-SOLR-3652','Issue SOLR-3652')">Issue SOLR-3652</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#cannon','Low Orbit Ion Cannon')">Low Orbit Ion Cannon</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#nist','National Vulnerability Database')">National Vulnerability Database</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Patch-9484','Patch #9484')">Patch #9484</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#SA-CONTRIB-2012-126','SA-CONTRIB-2012-126')">SA-CONTRIB-2012-126</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#zhou','Selective early request termination for busy internet services')">Selective early request termination for busy internet services</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#akamai','The State of the Internet')">The State of the Internet</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Ticket-11685','Ticket #11685')">Ticket #11685</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Ticket-19973','Ticket #19973')">Ticket #19973</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Ticket-1265946','Ticket 1265946')">Ticket 1265946</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Ticket-13275','Ticket 13275')">Ticket 13275</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Ticket-7336','Ticket 7336')">Ticket 7336</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#Ticket-9479','Ticket 9479')">Ticket 9479</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#bib-handle-switch','Web content adaptation to improve server overload behavior')">Web content adaptation to improve server overload behavior</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#bib','#handle-human','WebSOS: An Overlay-based System For Protecting Web Servers From Denial of Service Attacks')">WebSOS: An Overlay-based System For Protecting Web Servers From Denial of Service Attacks</a></li>
</ol>
</div>

<div id='CVE-2011-4858'>
<h2>CVE-2011-4858</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2011-4858','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2007-5712'>
<h2>CVE-2007-5712</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2007-5712','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2010-4535'>
<h2>CVE-2010-4535</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2010-4535','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='php'>
<h2>PHP</h2>
<ol>
<li><a href="javascript:Sidenote.openColumnLoud('#php','#Bug-60082','Bug #60082')">Bug #60082</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#php','#Bug-61240','Bug #61240')">Bug #61240</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#php','#CVE-2009-4017','CVE-2009-4017')">CVE-2009-4017</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#php','#CVE-2009-4418','CVE-2009-4418')">CVE-2009-4418</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#php','#CVE-2010-4645','CVE-2010-4645')">CVE-2010-4645</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#php','#CVE-2011-1471','CVE-2011-1471')">CVE-2011-1471</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#php','#CVE-2011-4885','CVE-2011-4885')">CVE-2011-4885</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#php','#CVE-2012-2336','CVE-2012-2336')">CVE-2012-2336</a></li>
</ol>
</div>

<div id='spec-eventually'>
<h2>Eventually</h2>
<p>Assume the worst case scenario. I.e., assume <em>N</em> requests arrive every moment for <em>M</em> moments, where <em>N</em> and <em>M</em> are arbitrarily large.</p>
<p>Assume there is a mix of legitimate requests and illegitimate requests, where the illegitimate requests cause an infinite amount of work.</p>
<p>Assume the Doorman uses an exponential back off and back on strategy on a per request basis.</p>
<p><strong>Theorem</strong>: Every request eventually reaches the worker.</p>
<p><strong>Proof</strong>: The exponential back off will cause the requests to fan out over time.</p>
</div>

<div id='CVE-2006-5467'>
<h2>CVE-2006-5467</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2006-5467','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='tomcat'>
<h2>Tomcat</h2>
<ol>
<li><a href="javascript:Sidenote.openColumnLoud('#tomcat','#Bug-44818','Bug 44818')">Bug 44818</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#tomcat','#CVE-2005-3510','CVE-2005-3510')">CVE-2005-3510</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#tomcat','#CVE-2011-0534','CVE-2011-0534')">CVE-2011-0534</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#tomcat','#CVE-2011-2526','CVE-2011-2526')">CVE-2011-2526</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#tomcat','#CVE-2011-4858','CVE-2011-4858')">CVE-2011-4858</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#tomcat','#CVE-2012-0022','CVE-2012-0022')">CVE-2012-0022</a></li>
</ol>
</div>

<div id='CVE-2004-0983'>
<h2>CVE-2004-0983</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2004-0983','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2009-3695'>
<h2>CVE-2009-3695</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2009-3695','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='bib-handle-switch'>
<h2>Web content adaptation to improve server overload behavior</h2>
<p>T. F. Abdelzaher and N. Bhatti, &#8220;<a href="http://www8.org/w8-papers/4c-server/web/web.pdf">Web content adaptation to improve server overload behavior</a>,&#8221; in World Wide Web Conference, 1999.</p>
</div>

<div id='django'>
<h2>Django</h2>
<ol>
<li><a href="javascript:Sidenote.openColumnLoud('#django','#CVE-2007-5712','CVE-2007-5712')">CVE-2007-5712</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#django','#CVE-2009-3695','CVE-2009-3695')">CVE-2009-3695</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#django','#CVE-2010-4535','CVE-2010-4535')">CVE-2010-4535</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#django','#CVE-2011-4137','CVE-2011-4137')">CVE-2011-4137</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#django','#CVE-2012-3443','CVE-2012-3443')">CVE-2012-3443</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#django','#CVE-2012-3444','CVE-2012-3444')">CVE-2012-3444</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#django','#Ticket-7336','Ticket 7336')">Ticket 7336</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#django','#Ticket-9479','Ticket 9479')">Ticket 9479</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#django','#Ticket-13275','Ticket 13275')">Ticket 13275</a></li>
</ol>
</div>

<div id='Ticket-13275'>
<h2>Ticket 13275</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#Ticket-13275','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='CVE-2011-1471'>
<h2>CVE-2011-1471</h2>
<p><strong>Software project</strong>: PHP</p>
<p><strong>Year</strong>: 2011</p>
<p><strong>Confidence</strong>: high<a href="javascript:Sidenote.openColumnLoud('#CVE-2011-1471','#conf','*')">*</a></p>
<p><strong>Summary</strong>: &#8220;Integer signedness error in zip_stream.c in the Zip extension in PHP before 5.3.6 allows context-dependent attackers to cause a denial of service (CPU consumption) via a malformed archive file that triggers errors in zip_fread function calls.&#8221; </p>
<p><strong>Characteristics</strong>: implementation error, malformed input</p>
<p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1471">Link</a></p>
</div>

<div id='prevalent'>
<h2>Prevalence</h2>
<p>Internet services are <a href="javascript:Sidenote.openColumnLoud('#prevalent','#gen-vuln','generally vulnerable')">generally vulnerable</a> to low-density attacks.</p>
<p>While not ubiquitous like low-density vulnerabilities, high-density vulnerabilities are prevalent. In our <a href="javascript:Sidenote.openColumnLoud('#prevalent','#bg-tech','2012 survey')">2012 survey</a> of 16 web systems we found 71 publicly known high-density vulnerabilities.</p>
</div>

<div id='CVE-2010-4476'>
<h2>CVE-2010-4476</h2>
<p><strong>Software project</strong>: </p>
<p><strong>Year</strong>: </p>
<p><strong>Confidence</strong>: <a href="javascript:Sidenote.openColumnLoud('#CVE-2010-4476','#conf','*')">*</a></p>
<p><strong>Summary</strong>: </p>
<p><strong>Characteristics</strong>: </p>
<p><a href="">Link</a></p>
</div>

<div id='spec-handback'>
<h2>Hands it back</h2>
<p>Recall, if the worker is busy, the <a href="javascript:Sidenote.openColumnLoud('#spec-handback','#spec-bouncer','Bouncer')">Bouncer</a> hands the request back to the Doorman.</p>
</div>
    </div>
  </body>
</html>

