
<!DOCTYPE html>
<meta charset="utf-8">
<html>
  <head>
    
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script src="js/jquery-1.10.1.js"></script>
    <script src="js/d3.v3.js"></script>
    <script src="js/lodash.js"></script>
    <script src="js/sidenote.js"></script>
  </head>
  <body>
    <div class="btn-group addRemoveColumn">
      <button class="btn"><a href="javascript:Sidenote.more()">more columns</a></button>
      <button class="btn"><a href="javascript:Sidenote.less()">fewer columns</a></button>
    </div>
    <div class="headerbox">
<h1>Zen Beer Garden</h1>
    </div>
    <ul id="breadcrumbs" class="breadcrumb"></ul>
    <div id='column-container'>
      <a href="javascript:Sidenote.goBack()"><img id="left-arrow" class="hide-arrow" src="img/left_arrow.png"></a>
      <a href="javascript:Sidenote.goForward()"><img id="right-arrow" class="hide-arrow" src="img/right_arrow.png"></a>
      <div class='column' id="column0"></div>
    </div>
    <div class="content-storage">
<div id='hd-lately'>
<h2>Lately</h2>
<p>See Akamai’s 2012 <a href="https://www.akamai.com/us/en/about/news/press/2012-press/akamai-first-quarter-2012-state-of-the-internet-report.jsp">The State of the Internet</a> report, Section 1.4 &#8220;Observed Denial-of-Service (DoS) Attack Activity.&#8221;</p>
</div>

<div id='ex-infinite'>
<h2>Infinite loops</h2>
<p>See for example the <a href="javascript:Sidenote.openColumnLoud('#ex-infinite','#CVE-2010-4645','PHP')">PHP</a> and <a href="javascript:Sidenote.openColumnLoud('#ex-infinite','#CVE-2010-4476','Java')">Java</a> floating-point vulnerabilities.</p>
</div>

<div id='hd-compare-stealth'>
<h2>Stealth</h2>
<p>Low-density attacks are easily detectable since the flood of requests produces many loud observables throughout the network. Monitoring the network &#8212; at any point in the path &#8212; clearly reveals the telltale signs of a DoS flood.</p>
<p>On the other hand, high-density attacks produce fewer observables. In practice, when a system experiences a high-density attack the operator observes the service outage then must troubleshoot to identify the cause. The effects of high-density attacks are often similar to the effects caused by accidental faults in the system.</p>
</div>

<div id='CVE-2010-4645'>
<h2>CVE-2010-4645</h2>
<p>&#8220;strtod.c, as used in the zend_strtod function in PHP 5.2 before 5.2.17 and 5.3 before 5.3.5, and other products, allows context-dependent attackers to cause a <strong>denial of service (infinite loop)</strong> via a certain floating-point value in scientific notation, which is not properly handled in x87 FPU registers, as demonstrated using 2.2250738585072011e-308.&#8221; &#8212; <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4645">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4645</a></p>
</div>

<div id='cdn'>
<h2>Note</h2>
<p>Content-delivery networks offer a form of economical over-provisioning.</p>
</div>

<div id='spec-legit'>
<h2>Legitimate requests</h2>
<p>A request is legitimate if it is <em>not</em> intended to overload the worker.</p>
<p>A request is malicious if it is intended to overload the worker.</p>
</div>

<div id='hd-asym'>
<h2>Small forces defeat larger forces</h2>
<p>For example, the Rebels used high-density attacks to destroy the Death Star, twice.</p>
<p><img src="img/deathstar.jpg"></p>
</div>

<div id='bg-tech'>
<h2>2012 Beer Garden Technical Report</h2>
<p>TODO</p>
</div>

<div id='simple-hd'>
<h2>Example of an unsophisticated high-density attack</h2>
<p>Consider a web application that uses an inefficient Ω(N<sup>2</sup>) algorithm to process web requests, where N represents the number of HTTP headers. An unsophisticated high-density attack could simply send a request with 10<sup>4</sup> headers, leading to 10<sup>8</sup> computations.</p>
</div>

<div id='hd-survey'>
<h2>Vulnerabilities</h2>
<p>TODO</p>
</div>

<div id='complex-hd'>
<h2>Example of a sophisticated high-density attack</h2>
<p>Consider the <a href="javascript:Sidenote.openColumnLoud('#complex-hd','#hashdos','HashDoS')">HashDoS</a> vulnerabilities discovered in 2011. The attacks exploit weaknesses in hash algorithms to trigger hash collisions, which leads to N<sup>2</sup> algorithmic performance and a subsequent denial of service.</p>
</div>

<div id='spec-zbg'>
<h2>The Zen Beer Garden Defense</h2>
<p>Guard every worker with a Bouncer and a Doorman.</p>
<p>Every request for work must go through the Doorman, then the Bouncer, before finally reaching the worker.</p>
<p>For example: <em>If a pharmaceutical rep wants Nancy to read an advertisement, the rep must give the ad to the Doorman, who then passes it to the Bouncer, who then might pass it to Nancy.</em></p>
</div>

<div id='hd-compare-power'>
<h2>Power</h2>
<p>High-density attacks are more <em>powerful</em> than low-density attacks, because high-density attacks create more work, per request.</p>
<p>For example, the <a href="javascript:Sidenote.openColumnLoud('#hd-compare-power','#hashdos','HashDoS')">HashDoS</a> high-density attack can consume 100% CPU using an attack with an attack rate less than 1 kilobit-per-second.</p>
<p>In contrast, low-density attacks are less potent and necessitate a large volume of malicious requests in order to succeed.</p>
</div>

<div id='spec-wr'>
<h2>Workers and Requests</h2>
<p>A worker is a thing that attempts to complete requests.</p>
<p>Every worker can complete a certain percentage of <a href="javascript:Sidenote.openColumnLoud('#spec-wr','#spec-legit','legitimate requests')">legitimate requests</a> (<em>Y</em>%) within a certain amount of time (<em>Z</em> seconds).</p>
<p>For example: <em>Nancy can complete 95% of professional requests within 3 hours.</em></p>
</div>

<div id='density'>
<h2>Density</h2>
<p>In the density metaphor, mass measures the victim&#8217;s resource consumption.</p>
<p>Volume measures the number of malicious resource requests.</p>
<p>Density measures the amount of victim resources consumed per malicious request (which, equivalently, is the ratio of mass to volume).</p>
</div>

<div id='spec-doorman'>
<h2>The Doorman</h2>
<p>When the Doorman receives a request from a requester, the Doorman passes it to the Bouncer.</p>
<p>If the Bouncer <a href="javascript:Sidenote.openColumnLoud('#spec-doorman','#spec-handback','hands it back')">hands it back</a>, then the Doorman turns the tables on the requester. Specifically, the Doorman invents some work for the requester to do. The Doorman passes the request back to the requester, and asks the requester to do the work the Doorman just invented.</p>
<p>For example: <em>If a rep wants to show Nancy an ad, but Nancy is busy, the Doorman might ask the rep to write a one-page essay explaining why the ad is relevant to Nancy in particular.</em></p>
<p>These requests are designed to delay the requester while at the same time possibly having the requester do useful work for the worker.</p>
<p>The Doorman will refuse to pass the original request until the requester completes the work request.</p>
<p>If the worker continues to be busy, the Doorman increases the amounts of work he asks of requesters.</p>
<p><em>If Nancy is bombarded by reps, she might ask reps for 10-page essays. Of course, every essay must come with a one-page summary.</em></p>
<p>As the worker becomes less busy, the Doorman decreases the amounts of work he asks of requesters.</p>
</div>

<div id='abstract-success'>
<h2>ZBG succeeded for two of the web applications</h2>
<p>TODO</p>
<p>ZBG successfully protected the PHP and Python applications because they have low memory footprints and fast restart times.</p>
<p>A different software approach would be necessary for Zen Beer Garden to successfully defend web applications with high memory footprints or slow restart times.</p>
</div>

<div id='enlarge'>
<h2>How to enlarge an image</h2>
<p>Decrease the number of columns by clicking &#8220;<strong>fewer columns</strong>&#8221; in the upper right-hand corner. The fewer the columns, the larger the image.</p>
<p>When you&#8217;re done, click &#8220;<strong>more columns</strong>&#8221; until you&#8217;re happy with the number of columns.</p>
<p>Try it out.</p>
<p><img src="img/deathstar.jpg"></p>
<p><a href="javascript:Sidenote.openColumnLoud('#enlarge','#enlarge-req','Note to hackers')">Note to hackers</a>.</p>
</div>

<div id='abstract-simple'>
<h2>Simple approach</h2>
<p>Zen Beer Garden protects each worker with a <em>Doorman</em> and a <em>Bouncer</em>.</p>
<p>The Doorman charges admission fees, which limits the amount of requests the worker receives.</p>
<p>The Bouncer kicks out requests that overload the worker.</p>
<p>The <a href="javascript:Sidenote.openColumnLoud('#abstract-simple','#spec','algorithm')">algorithm</a> can be summed up as: &#8220;If you&#8217;re busy and someone hands you a lemon, hand it back and ask for lemonade.&#8221;</p>
</div>

<div id='spec-eventually'>
<h2>Eventually</h2>
<p>Assume the worst case scenario. I.e., assume <em>N</em> requests arrive every moment for <em>M</em> moments, where <em>N</em> and <em>M</em> are arbitrarily large.</p>
<p>Assume there is a mix of legitimate requests and illegitimate requests, where the illegitimate requests cause an infinite amount of work.</p>
<p>Assume the Doorman uses an exponential back off and back on strategy on a per request basis.</p>
<p><strong>Theorem</strong>: Every request eventually reaches the worker.</p>
<p><strong>Proof</strong>: The exponential back off will cause the requests to fan out over time.</p>
</div>

<div id='enlarge-req'>
<h2>Note to hackers</h2>
<p>I would love a Github pull request on <a href="https://github.com/mikegagnon/sidenote">Sidenote</a>  so that we can enlarge images with an overlay, on click. :-)</p>
</div>

<div id='recycle'>
<h2>Less recyclable</h2>
<p>Low-density attacks are generally recyclable, in the sense that the same attack can be recycled and used again. They are recyclable since low-density vulnerabilities are inherent to the design of the Internet; defenders have a limited ability to defend themselves from high- volume, low-density attacks.</p>
<p>In contrast, high-density attacks are not generally recyclable since they target specific implementation level vulnerabilities. In most cases, once the defender is subjected to an attack it is straightforward to fix the implementation &#8212; making it invulnerable to that specific attack.</p>
</div>

<div id='spec-sec'>
<h2>Theoretical Security Guarantee</h2>
<p>Zen Beer Garden is 100% effective.&#42;</p>
<p>If you use the Zen Beer Garden defense, you will never&#42; become overloaded. No matter what,&#42; <em>Y%</em> of legitimate requests are guaranteed to eventually complete.</p>
<p>&#42; <em>As long Doormen and Bouncers don’t get overloaded, legitimate requesters are patient, legitimate requesters are willing to work, your boss is competent, etc.</em></p>
</div>

<div id='main'>
<p>&#8220;If you&#8217;re busy and someone hands you a lemon, hand it back and ask for lemonade.&#8221;</p>
<p>This document presents <em>Zen Beer Garden</em>, a proven approach for defending systems against work-based <a href="javascript:Sidenote.openColumnLoud('#main','#hd','high-density attacks')">high-density attacks</a>. </p>
<p>Today’s applications, frameworks, languages, and servers crumble when subjected to high- density attacks.</p>
<p>Zen Beer Garden defends against these attacks using a <a href="javascript:Sidenote.openColumnLoud('#main','#abstract-simple','simple approach')">simple approach</a>.</p>
<p>We have <a href="javascript:Sidenote.openColumnLoud('#main','#zbg','experimentally verified')">experimentally verified</a> that Zen Beer Garden can successfully defend web applications against high-density attacks.</p>
<hr>
<p><a href="javascript:Sidenote.openColumnLoud('#main','#howto','How to read this document')">How to read this document</a>.</p>
<p><a href="javascript:Sidenote.openColumnLoud('#main','#index','Index')">Index</a></p>
</div>

<div id='hashdos'>
<h2>HashDoS</h2>
<p>The HashDoS attack against CRuby 1.8 can keep one i7 core 100% busy with an attack rate of 720 bits/s.</p>
<p>See Alexander Klink and Julian Walde, &#8220;<a href="https://events.ccc.de/congress/2011/Fahrplan/attachments/2007_28C3_Effective_DoS_on_web_application_platforms.pdf">Efficient Denial of Service Attacks on Web Application Platforms</a>,&#8221; in The 28th Chaos Communication Congress, 2011.</p>
</div>

<div id='spec-intro'>
<h2>Introduction to Zen Beer Garden</h2>
<p>You should protect workers from overloads by placing Doormen and Bouncers between workers and requesters.</p>
<p>Theoretically, the Zen Beer Garden defense is 100% effective, even against the most threatening deluges.</p>
<p>In practice, the Zen Beer Garden defense tends to be effective, although there are many reasons the defense might fail.</p>
</div>

<div id='zbg'>
<h2>Experimentally verified</h2>
<p>To test Zen Beer Garden, we built a software system called <em>ZBG</em>.</p>
<p>ZBG defends web applications against high-density cyber attacks.</p>
<p>For our experiments, we installed ZBG over top of <a href="javascript:Sidenote.openColumnLoud('#zbg','#abstract-apps','four different web applications')">four different web applications</a>.</p>
<p>We subjected the applications to a suite of 10 different attacks of varying sophistication.</p>
<p>ZBG succeeded for <a href="javascript:Sidenote.openColumnLoud('#zbg','#abstract-success','two of the web applications')">two of the web applications</a>.</p>
<p>Our experiments show that Zen Beer Garden works.</p>
</div>

<div id='solr-3652'>
<h2>Issue SOLR-3652</h2>
<p>TODO. See section 3.12</p>
</div>

<div id='hd-compare-econ'>
<h2>Economics</h2>
<p>High-density attacks are more economical since they are more <a href="javascript:Sidenote.openColumnLoud('#hd-compare-econ','#hd-compare-power','more powerful')">more powerful</a>.</p>
<p>It is often possible to launch a successful high-density attack using the resources of a single attacker machine.</p>
<p>In contrast, low-density attacks require more attacker resources since they are less potent.</p>
<p>To successfully execute a low-density attack against a well-resourced victim, attackers most often require an entire army of attacking machines (i.e. a botnet).</p>
</div>

<div id='hd-compare'>
<h2>Compared to conventional low-density attacks</h2>
<p><a href="javascript:Sidenote.openColumnLoud('#hd-compare','#density','Mass, volume, and density metaphor')">Mass, volume, and density metaphor</a></p>
<p>Low-density attacks are <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#low-density','conventional floods')">conventional floods</a>.</p>
<p>Low-density vulnerabilities are <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#prevalent','more prevalent')">more prevalent</a> than high-density vulnerabilities.</p>
<p>High-density attacks are <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#hd-compare-power','powerful')">powerful</a>, <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#hd-compare-econ','economical')">economical</a>, <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#hd-compare-stealth','stealthy')">stealthy</a>, <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#specialized','specialized')">specialized</a>, <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#recycle','less recyclable')">less recyclable</a>, and they vary in <a href="javascript:Sidenote.openColumnLoud('#hd-compare','#sophisticated','sophistication')">sophistication</a>.</p>
</div>

<div id='index'>
<h2>Index</h2>
<ul>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#bg-tech','2012 Beer Garden Technical Report')">2012 Beer Garden Technical Report</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-terms','A note on terminology')">A note on terminology</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-ex','Example work-based high-density attack')">Example work-based high-density attack</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-eventually','Every legitimate request eventually reaches the worker because the worker will eventually be free or bored at the same time that the legitimate request arrives in the Doorman&amp;#8217;s hands')">Every legitimate request eventually reaches the worker because the worker will eventually be free or bored at the same time that the legitimate request arrives in the Doorman&#8217;s hands</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#abstract-apps','For our experiments, we installed ZBG over top of four different web applications')">For our experiments, we installed ZBG over top of four different web applications</a>.</li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd','High-density attacks')">High-density attacks</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-asym','High-density attacks allow small forces to defeat larger forces')">High-density attacks allow small forces to defeat larger forces</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-compare-econ','High-density attacks are *economical*')">High-density attacks are <em>economical</em></a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#recycle','High-density attacks are *less recyclable*')">High-density attacks are <em>less recyclable</em></a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-compare-power','High-density attacks are *powerful*')">High-density attacks are <em>powerful</em></a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#specialized','High-density attacks are *specialized*')">High-density attacks are <em>specialized</em></a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-compare-stealth','High-density attacks are *stealthy*')">High-density attacks are <em>stealthy</em></a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-compare','High-density attacks compared to conventional low-density attacks')">High-density attacks compared to conventional low-density attacks</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#sophisticated','High-density attacks vary in *sophisticated*')">High-density attacks vary in <em>sophisticated</em></a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-survey','High-density vulnerabilities are everywhere')">High-density vulnerabilities are everywhere</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#columns','How columns work')">How columns work</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#enlarge','How to enlarge an image')">How to enlarge an image</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#howto','How to read this document')">How to read this document</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-handback','If the Bouncer hands it back, then the Doorman turns the tables on the requester')">If the Bouncer hands it back, then the Doorman turns the tables on the requester</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#solr-3652','Issue SOLR-3652')">Issue SOLR-3652</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#gen-vuln','Internet services are generally vulnerable to low-density attacks')">Internet services are generally vulnerable to low-density attacks</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#CVE-2010-4476','Java infinite-loop high-density vulnerability')">Java infinite-loop high-density vulnerability</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#hd-lately','Lately attackers have been increasingly utilizing high-density attacks')">Lately attackers have been increasingly utilizing high-density attacks</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-legit','Legitimate requests')">Legitimate requests</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#ld-specialize','Low-density attacks require little-to-no specialization')">Low-density attacks require little-to-no specialization</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#prevalent','Low-density vulnerabilities are more prevalent than high-density vulnerabilities')">Low-density vulnerabilities are more prevalent than high-density vulnerabilities</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#enlarge-req','Note to hackers')">Note to hackers</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#cdn','Note: content-delivery networks offer a form of economical over-provisioning')">Note: content-delivery networks offer a form of economical over-provisioning</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#atm','Note: not all network protocols are inherently vulnerable to low-density attacks')">Note: not all network protocols are inherently vulnerable to low-density attacks</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#CVE-2010-4645','PHP infinite-loop high-density vulnerability')">PHP infinite-loop high-density vulnerability</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec','The algorithm can be summed up as: &amp;#8220;If you&amp;#8217;re busy and someone hands you a lemon, hand it back and ask for lemonade.&amp;#8221;')">The algorithm can be summed up as: &#8220;If you&#8217;re busy and someone hands you a lemon, hand it back and ask for lemonade.&#8221;</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-wr','The algorithm: Workers and Requests')">The algorithm: Workers and Requests</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-bbf','The algorithm: Busy, Bored, and Free')">The algorithm: Busy, Bored, and Free</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-overloads','The algorithm: Overloads')">The algorithm: Overloads</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-intro','The algorithm: Introduction to Zen Beer Garden')">The algorithm: Introduction to Zen Beer Garden</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-sec','The algorithm: Theoretical Security Guarantee')">The algorithm: Theoretical Security Guarantee</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-zbg','The algorithm: The Zen Beer Garden Defense')">The algorithm: The Zen Beer Garden Defense</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-bouncer','The algorithm: The Bouncer')">The algorithm: The Bouncer</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-doorman','The algorithm: The Doorman')">The algorithm: The Doorman</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#spec-proof','The algorithm: Proof for Security Guarantee')">The algorithm: Proof for Security Guarantee</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#low-density','Low-density attacks are conventional floods')">Low-density attacks are conventional floods</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#density','Mass, volume, and density metaphor')">Mass, volume, and density metaphor</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#zbg','We have experimentally verified that Zen Beer Garden can successfully defend web applications against high-density attacks')">We have experimentally verified that Zen Beer Garden can successfully defend web applications against high-density attacks</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#abstract-success','ZBG succeeded for two of the web applications')">ZBG succeeded for two of the web applications</a>.</li>
<li><a href="javascript:Sidenote.openColumnLoud('#index','#abstract-simple','Zen Beer Garden defends against these attacks using a simple approach')">Zen Beer Garden defends against these attacks using a simple approach</a></li>
</ul>
</div>

<div id='spec-bouncer'>
<h2>The Bouncer</h2>
<p>If the worker is free, the Bouncer passes the request to the worker.</p>
<p>If the worker is bored, the Bouncer asks the worker to stop working on her current task and accept the new request. The Bouncer then informs the old requester that her request was bounced.</p>
<p>If the worker is busy, the Bouncer hands the request back to the Doorman.</p>
</div>

<div id='howto'>
<h2>How to read this document</h2>
<p>This document is presented in <a href="https://github.com/mikegagnon/sidenote">Sidenote</a> format.</p>
<ul>
<li>Click the links you&#8217;re interested ins</li>
<li><a href="javascript:Sidenote.openColumnLoud('#howto','#enlarge','How to enlarge an image')">How to enlarge an image</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#howto','#columns','How columns work')">How columns work</a></li>
</ul>
</div>

<div id='ld-specialize'>
<h2>Little-to-no specialization</h2>
<p>All that is needed is the ability to generate a large volume of traffic towards the victim. There exist a variety of generic, off-the-shelf tools that can be used to launch effective low-density attacks. For example, the <a href="https://en.wikipedia.org/wiki/Low_Orbit_Ion_Cannon">Low Orbit Ion Cannon</a> can target any web service on the Internet.</p>
</div>

<div id='sophisticated'>
<h2>Sophisticated</h2>
<p>High-density attacks vary in the sophistication required to conduct the attack. <a href="javascript:Sidenote.openColumnLoud('#sophisticated','#simple-hd','Unsophisticated example')">Unsophisticated example</a>. </p>
<p>Many high-density vulnerabilities require sophisticated attacks. <a href="javascript:Sidenote.openColumnLoud('#sophisticated','#complex-hd','Sophisticated example')">Sophisticated example</a>.</p>
</div>

<div id='spec-bbf'>
<h2>Busy, Bored, and Free</h2>
<ul>
<li>A worker is busy if she has been working on her current request for less than <em>Z</em> seconds.</li>
<li>A worker is bored if she has been working on her current request for <em>Z</em> seconds or more.</li>
<li>A worker is free if she isn&#8217;t doing any work at all.</li>
</ul>
</div>

<div id='hd-terms'>
<h2>A note on terminology</h2>
<p>For the sake of brevity, throughout the rest of this document, unless specified otherwise, the term <em>high-density attack</em> refers to <em>work-based high-density cyber attack</em>.</p>
<p>Zen Beer Garden only defends against <em>work-based</em> attacks.</p>
<p>Our experimental implementation, <a href="javascript:Sidenote.openColumnLoud('#hd-terms','#zbg','ZBG')">ZBG</a>, only defends against work-based <em>cyber</em> attacks.</p>
</div>

<div id='gen-vuln'>
<h2>General vulnerability</h2>
<p>First the design of the TCP/IP protocol suite is inherently vulnerable to low-density attacks since it does not enforce any quality of service (QoS); i.e. the network itself makes no attempt to ensure that misbehaving users can&#8217;t infringe on the quality of service for other users. <a href="javascript:Sidenote.openColumnLoud('#gen-vuln','#atm','Note')">Note</a>.</p>
<p>Second, typical server software does not limit resource usage per user.</p>
<p>Lastly, most Internet servers are under provisioned because straightforward over-provisioning is not cost effective. <a href="javascript:Sidenote.openColumnLoud('#gen-vuln','#cdn','Note')">Note</a>.</p>
<p>These deficiencies make it possible for attackers to consume large amounts of resources simply by submitting large volumes of requests.</p>
</div>

<div id='low-density'>
<h2>Flood</h2>
<p>In a flood attack, the attacker consumes a <em>massive</em> amount of victim resources by flooding the victim with a large <em>volume</em> of resource requests.</p>
<p>For a low-density attack to be effective, the attacker must generate a large volume of requests, which can be accomplished using an army of attack computers (such as a botnet).</p>
</div>

<div id='hd-ex'>
<h2>Example work-based high-density attacks</h2>
<p><em>Hypothetical example</em>: Bob transmits a single HTTP request to Wikipedia, which causes Wikipedia to spin so much CPU there&#8217;s a blackout for everyone.</p>
<p><em>Real examples</em>:</p>
<ul>
<li>Bob triggers logic errors that lead to <a href="javascript:Sidenote.openColumnLoud('#hd-ex','#ex-infinite','infinite loops')">infinite loops</a> on the server.</li>
<li>Bob causes an SQL database to execute <a href="javascript:Sidenote.openColumnLoud('#hd-ex','#ex-sql','exorbitantly expensive database operations')">exorbitantly expensive database operations</a>.</li>
<li>Bob triggers <a href="javascript:Sidenote.openColumnLoud('#hd-ex','#ex-re','excessive regular-expression backtracking')">excessive regular-expression backtracking</a>.</li>
</ul>
<p>TODO: Link to vulns and attacks used in experiments</p>
</div>

<div id='ex-sql'>
<h2>Exorbitantly expensive database operations</h2>
<p>See for example Django Ticket 9479 in our survey as well as our SQL-overload experiment in Section 6.2.8</p>
<p>TODO: Full report</p>
</div>

<div id='hd'>
<h2>High-density attacks</h2>
<p>A high-density attack is when a tiny bomb causes a huge explosion.</p>
<p>A <em>work-based</em> high-density attack is one where the tiny bomb causes the victim to perform an explosive amount of work. <a href="javascript:Sidenote.openColumnLoud('#hd','#hd-ex','Examples')">Examples</a>.</p>
<p><a href="javascript:Sidenote.openColumnLoud('#hd','#hd-terms','A note on terminology')">A note on terminology</a>.</p>
<p><a href="javascript:Sidenote.openColumnLoud('#hd','#hd-compare','Compared to conventional low-density attacks')">Compared to conventional low-density attacks</a>, high density attacks are particularly dangerous because they are particularly powerful, economical, and stealthy.</p>
<p>With high-density attacks, you don’t need an entire army to attack your enemies. You just need tiny bombs.</p>
<p>High-density attacks allow <a href="javascript:Sidenote.openColumnLoud('#hd','#hd-asym','small forces to defeat larger forces')">small forces to defeat larger forces</a>.</p>
<p>High-density <a href="javascript:Sidenote.openColumnLoud('#hd','#hd-survey','vulnerabilities')">vulnerabilities</a> are everywhere.</p>
<p><a href="javascript:Sidenote.openColumnLoud('#hd','#hd-lately','Lately')">Lately</a>, attackers have been increasingly utilizing high-density attacks since the defenses against conventional DoS attacks are becoming increasingly effective.</p>
</div>

<div id='columns'>
<h2>How columns work</h2>
<p>To increase or decrease the number of columns, click &#8220;<strong>more columns</strong>&#8221; or &#8220;<strong>fewer columns</strong>&#8221; in the upper right corner of the page</p>
<p>If a column is moved off screen, and you want to see that column again, just click the &#8220;<strong>back</strong>&#8221; or &#8220;<strong>forward</strong>&#8221; blue arrows.</p>
<p><img src="img/arrows.png"></p>
</div>

<div id='prevalent'>
<h2>Prevalence</h2>
<p>Internet services are <a href="javascript:Sidenote.openColumnLoud('#prevalent','#gen-vuln','generally vulnerable')">generally vulnerable</a> to low-density attacks.</p>
<p>While not ubiquitous like low-density vulnerabilities, high-density vulnerabilities are prevalent. In our <a href="javascript:Sidenote.openColumnLoud('#prevalent','#bg-tech','2012 survey')">2012 survey</a> of 16 web systems we found 71 publicly known high-density vulnerabilities.</p>
</div>

<div id='atm'>
<h2>Note</h2>
<p>Not all network protocols are inherently vulnerable to low-density attacks. For example, the ATM protocol has quality-of-service (QoS) policing built into the network.</p>
</div>

<div id='spec-proof'>
<h2>Proof for Security Guarantee</h2>
<p>At least <em>Y</em>% of legitimate requests that reach the worker complete. We know this because the Bouncer only bounces a request after the worker has been working on it for at least <em>Z</em> seconds.</p>
<p>Every legitimate request eventually reaches the worker because the worker will <a href="javascript:Sidenote.openColumnLoud('#spec-proof','#spec-eventually','eventually')">eventually</a> be free or bored at the same time that the legitimate request arrives in the Doorman&#8217;s hands. Of course, the requester might have performed quite a bit of work in order to convince the Doorman to accept the request.</p>
</div>

<div id='spec'>
<h2>Algorithm</h2>
<p>This section provides the algorithmic specification for Zen Beer Garden, it&#8217;s security guarantee, and a simple proof.</p>
<ul>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-wr','Workers and Requests')">Workers and Requests</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-bbf','Busy, Bored, and Free')">Busy, Bored, and Free</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-overloads','Overloads')">Overloads</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-intro','Introduction to Zen Beer Garden')">Introduction to Zen Beer Garden</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-sec','Theoretical Security Guarantee')">Theoretical Security Guarantee</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-zbg','The Zen Beer Garden Defense')">The Zen Beer Garden Defense</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-bouncer','The Bouncer')">The Bouncer</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-doorman','The Doorman')">The Doorman</a></li>
<li><a href="javascript:Sidenote.openColumnLoud('#spec','#spec-proof','Proof for Security Guarantee')">Proof for Security Guarantee</a></li>
</ul>
</div>

<div id='spec-overloads'>
<h2>Overloads</h2>
<p>A worker can become overloaded under a variety of circumstances.</p>
<p>Requests might be coming in too quickly.</p>
<p>Or, there might be a deluge of work-intensive requests.</p>
<p>Or, in the worst-case scenario, a worker might be subjected to an incessant stream of impossible-to-fulfill requests.</p>
<p>Workers should protect themselves from overloads by employing the Zen Beer Garden defense.</p>
</div>

<div id='abstract-apps'>
<h2>Four different web applications</h2>
<p>TODO</p>
<p>PHP, Python, Java, and Ruby.</p>
</div>

<div id='specialized'>
<h2>Specialization</h2>
<p>Low-density attacks require <a href="javascript:Sidenote.openColumnLoud('#specialized','#ld-specialize','little-to-no specialization')">little-to-no specialization</a> in order to attack a particular target.</p>
<p>High-density attacks on the other hand require attacks tailored to application-specific vulnerabilities. For example, an attack might need to exploit an underflow to cause excessive looping, as exemplified by <a href="javascript:Sidenote.openColumnLoud('#specialized','#solr-3652','Issue SOLR-3652')">Issue SOLR-3652</a>.</p>
</div>

<div id='spec-handback'>
<h2>Hands it back</h2>
<p>Recall, if the worker is busy, the <a href="javascript:Sidenote.openColumnLoud('#spec-handback','#spec-bouncer','Bouncer')">Bouncer</a> hands the request back to the Doorman.</p>
</div>

<div id='ex-re'>
<h2>Excessive regular-expression backtracking</h2>
<p>See for example the Django vulnerability CVE-2009-3695 as well as our regex-overload experiment in Section 6.3.5</p>
<p>TODO: Full report</p>
</div>

<div id='CVE-2010-4476'>
<h2>CVE-2010-4476</h2>
<p>&#8220;The Double.parseDouble method in Java Runtime Environment (JRE) in Oracle Java SE and Java for Business 6 Update 23 and earlier, 5.0 Update 27 and earlier, and 1.4.2_29 and earlier, as used in OpenJDK, Apache, JBossweb, and other products, allows remote attackers to cause a <strong>denial of service via a crafted string that triggers an infinite loop</strong> of estimations during conversion to a double-precision binary floating-point number, as demonstrated using 2.2250738585072012e-308.&#8221; &#8212; <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4476">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4476</a></p>
</div>
    </div>
  </body>
</html>

